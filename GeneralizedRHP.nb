(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    191978,       4815]
NotebookOptionsPosition[    186697,       4721]
NotebookOutlinePosition[    187097,       4737]
CellTagsIndexPosition[    187054,       4734]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Red Hot Potato Algorithm", "Title",
 CellChangeTimes->{{3.6986649132299533`*^9, 
  3.6986649572979555`*^9}},ExpressionUUID->"353f7f4e-b6c8-4fbe-a8a0-\
ffff6354133d"],

Cell[CellGroupData[{

Cell["Building-block Functions", "Section",
 CellChangeTimes->{{3.7005589861963067`*^9, 
  3.7005589915933576`*^9}},ExpressionUUID->"19e9dab3-8b82-459c-af45-\
f22713da48ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"both", "[", 
    RowBox[{"f_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"f", "[", "x", "]"}], "&&", 
    RowBox[{"f", "[", "y", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NiceGraph", "[", 
    RowBox[{"v_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"Graph", "[", 
    RowBox[{"v", ",", "e", ",", 
     RowBox[{"EdgeStyle", "\[Rule]", "Black"}], ",", 
     RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}], ",", 
     RowBox[{"GraphLayout", "\[Rule]", "\"\<CircularEmbedding\>\""}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"outdegree0or1", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"VertexOutDegree", "[", "x", "]"}], ",", "0"}], "]"}], "+", 
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{"VertexOutDegree", "[", "x", "]"}], ",", "1"}], "]"}]}], 
    "\[Equal]", 
    RowBox[{"Length", "[", 
     RowBox[{"VertexOutDegree", "[", "x", "]"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"root", "[", 
    RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"VertexOutDegree", "[", 
     RowBox[{"x", ",", "n"}], "]"}], "\[Equal]", "0"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"numroot", "[", "x_", "]"}], ":=", 
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"VertexOutDegree", "[", "x", "]"}], ",", "0"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pointsto", "[", 
    RowBox[{"x_", ",", "n1_", ",", "n2_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"VertexList", "[", 
      RowBox[{"FindSpanningTree", "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "n1"}], "}"}], "]"}], "]"}], ",", "n2"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cycle", "[", "x_", "]"}], ":=", 
   RowBox[{"Graph", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"FindCycle", "[", 
      RowBox[{"x", ",", "Infinity", ",", "All"}], "]"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnRed", "[", 
    RowBox[{"x_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"SetProperty", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "e"}], "}"}], ",", 
     RowBox[{"EdgeStyle", "\[Rule]", "Red"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TurnBlack", "[", 
    RowBox[{"x_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"SetProperty", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "e"}], "}"}], ",", 
     RowBox[{"EdgeStyle", "\[Rule]", "Black"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxCycle", "[", "x_", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"FindCycle", "[", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Max", "[", 
        RowBox[{"VertexList", "[", 
         RowBox[{"Cycle", "[", "x", "]"}], "]"}], "]"}]}], "}"}], "]"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BetterFirst", "[", "s_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"s", "!=", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"First", "[", "s", "]"}], ",", 
     RowBox[{"{", "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EdgeOut", "[", 
    RowBox[{"x_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"BetterFirst", "[", 
    RowBox[{"EdgeList", "[", 
     RowBox[{"x", ",", 
      RowBox[{"DirectedEdge", "[", 
       RowBox[{"i", ",", "_"}], "]"}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsRed", "[", 
    RowBox[{"x_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"PropertyValue", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"EdgeOut", "[", 
           RowBox[{"x", ",", "i"}], "]"}]}], "}"}], ",", "EdgeStyle"}], "]"}],
       "}"}], ",", "Red"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IsBlack", "[", 
    RowBox[{"x_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"PropertyValue", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", 
          RowBox[{"EdgeOut", "[", 
           RowBox[{"x", ",", "i"}], "]"}]}], "}"}], ",", "EdgeStyle"}], "]"}],
       "}"}], ",", "Black"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Colored", "[", 
    RowBox[{"x_", ",", "e_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"PropertyValue", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "e"}], "}"}], ",", "EdgeStyle"}], "]"}], "}"}], 
     ",", "Red"}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HighestCycle", "[", "x_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Colored", "[", 
      RowBox[{"x", ",", 
       RowBox[{"First", "[", 
        RowBox[{"MaxCycle", "[", "x", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"TurnBlack", "[", 
      RowBox[{"x", ",", 
       RowBox[{"MaxCycle", "[", "x", "]"}]}], "]"}], ",", 
     RowBox[{"TurnRed", "[", 
      RowBox[{"x", ",", 
       RowBox[{"MaxCycle", "[", "x", "]"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxCycleVertex", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"VertexList", "[", 
      RowBox[{"Cycle", "[", "x", "]"}], "]"}], ",", 
     RowBox[{"Max", "[", 
      RowBox[{
       RowBox[{"VertexList", "[", 
        RowBox[{"Cycle", "[", "x", "]"}], "]"}], ",", 
       RowBox[{"VertexList", "[", 
        RowBox[{"Cycle", "[", "y", "]"}], "]"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InTree", "[", 
    RowBox[{"x_", ",", "n1_", ",", "n2_"}], "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{
     RowBox[{"VertexList", "[", 
      RowBox[{"FindSpanningTree", "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "n1"}], "}"}], "]"}], "]"}], ",", "n2"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SpanningTree", "[", 
    RowBox[{"x_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"EdgeList", "[", 
    RowBox[{"FindSpanningTree", "[", 
     RowBox[{"{", 
      RowBox[{"x", ",", "i"}], "}"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"succ", "[", 
    RowBox[{"x_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"VertexList", "[", 
      RowBox[{"EdgeList", "[", 
       RowBox[{"x", ",", 
        RowBox[{"DirectedEdge", "[", 
         RowBox[{"n", ",", "_"}], "]"}]}], "]"}], "]"}], ",", "n"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RedEdges", "[", "x_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "=", "0"}], ";", 
        RowBox[{"b", "=", 
         RowBox[{"{", "}"}]}]}], ",", 
       RowBox[{"MemberQ", "[", 
        RowBox[{
         RowBox[{"VertexList", "[", "x", "]"}], ",", "a"}], "]"}], ",", 
       RowBox[{"a", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"EdgeList", "[", 
            RowBox[{"x", ",", 
             RowBox[{"DirectedEdge", "[", 
              RowBox[{"a", ",", "_"}], "]"}]}], "]"}], "]"}], "\[Equal]", 
          "0"}], ",", 
         RowBox[{"b", "\[Equal]", "b"}], ",", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"len", "=", "1"}], ",", 
           RowBox[{"len", "<", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"EdgeList", "[", 
                RowBox[{"x", ",", 
                 RowBox[{"DirectedEdge", "[", 
                  RowBox[{"a", ",", "_"}], "]"}]}], "]"}], "]"}], "+", "1"}], 
             ")"}]}], ",", 
           RowBox[{"len", "++"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"PropertyValue", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", 
                    RowBox[{"Part", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"a", ",", "_"}], "]"}]}], "]"}], ",", "len"}], 
                    "]"}]}], "}"}], ",", "EdgeStyle"}], "]"}], "}"}], ",", 
               "Red"}], "]"}], ",", 
             RowBox[{"b", "=", 
              RowBox[{"Union", "[", 
               RowBox[{"b", ",", 
                RowBox[{"{", 
                 RowBox[{"Part", "[", 
                  RowBox[{
                   RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"a", ",", "_"}], "]"}]}], "]"}], ",", "len"}], 
                  "]"}], "}"}]}], "]"}]}], ",", 
             RowBox[{"b", "=", "b"}]}], "]"}]}], "]"}]}], "]"}]}], "]"}], ";",
      "b"}], ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Deletei", "[", 
    RowBox[{"x_", ",", "edges_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{"edges", ",", 
     RowBox[{"EdgeOut", "[", 
      RowBox[{"x", ",", "i"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Addi", "[", 
    RowBox[{"x_", ",", "edges_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Append", "[", 
     RowBox[{"edges", ",", 
      RowBox[{"EdgeList", "[", 
       RowBox[{"x", ",", 
        RowBox[{"DirectedEdge", "[", 
         RowBox[{"i", ",", "_"}], "]"}]}], "]"}]}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PathSoFar", "[", 
    RowBox[{"n_", ",", "v_", ",", "edge_"}], "]"}], ":=", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sf", "=", "1"}], ";", 
      RowBox[{"vl", "=", 
       RowBox[{"{", "}"}]}]}], ",", 
     RowBox[{"sf", "<", "v"}], ",", 
     RowBox[{"sf", "++"}], ",", 
     RowBox[{"vl", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Union", "[", 
        RowBox[{"vl", ",", 
         RowBox[{"FindPath", "[", 
          RowBox[{
           RowBox[{"NiceGraph", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", 
               RowBox[{"n", "-", "1"}]}], "]"}], ",", "edge"}], "]"}], ",", 
           "sf", ",", "v"}], "]"}]}], "]"}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DeleteCasesSuper", "[", 
    RowBox[{"origlist_", ",", "deletelist_"}], "]"}], ":=", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"o", "=", "0"}], ";", 
      RowBox[{"finallist", "=", "origlist"}]}], ",", 
     RowBox[{"MemberQ", "[", 
      RowBox[{"origlist", ",", "o"}], "]"}], ",", 
     RowBox[{"o", "++"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"deletelist", ",", "o"}], "]"}], ",", 
       RowBox[{"finallist", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"finallist", ",", "o"}], "]"}]}], ",", 
       RowBox[{"finallist", "=", "finallist"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rootoftheta", "[", 
    RowBox[{"y_", ",", "theta_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"end", "=", "0"}], ";", 
        RowBox[{"appedge", "=", "theta"}]}], ",", 
       RowBox[{"end", "<", 
        RowBox[{"k", "+", "1"}]}], ",", 
       RowBox[{"end", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"end", "\[NotEqual]", "theta"}], "&&", 
          RowBox[{"pointsto", "[", 
           RowBox[{"y", ",", "theta", ",", "end"}], "]"}]}], ",", 
         RowBox[{"appedge", "=", "end"}], ",", 
         RowBox[{"appedge", "=", "appedge"}]}], "]"}]}], "]"}], ";", 
     "appedge"}], ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DetectDuplicates", "[", "list_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"l", "=", 
      RowBox[{"Length", "[", "list", "]"}]}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"T", "=", "True"}], ";", 
        RowBox[{"le", "=", "1"}]}], ",", 
       RowBox[{
        RowBox[{"le", "<", 
         RowBox[{"l", "+", "1"}]}], "&&", 
        RowBox[{"T", "\[Equal]", "True"}]}], ",", 
       RowBox[{"le", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"list", ",", 
             RowBox[{"list", "[", 
              RowBox[{"[", "le", "]"}], "]"}]}], "]"}], "]"}], "<", 
          RowBox[{"l", "-", "1"}]}], ",", 
         RowBox[{"T", "=", "T"}], ",", 
         RowBox[{"T", "=", "False"}]}], "]"}]}], "]"}], ";", "T"}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomTree", "[", "n_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "=", "1"}], ";", 
        RowBox[{"vert", "=", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{"n", "-", "1"}]}], "]"}]}], ";", 
        RowBox[{"edge", "=", 
         RowBox[{"{", "}"}]}]}], ",", 
       RowBox[{"v", "<", "n"}], ",", 
       RowBox[{"v", "++"}], ",", 
       RowBox[{
        RowBox[{"PathSoFar", "[", 
         RowBox[{"n", ",", "v", ",", "edge"}], "]"}], ";", 
        RowBox[{"DeleteCasesSuper", "[", 
         RowBox[{"vert", ",", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"{", "v", "}"}], ",", "vl"}], "]"}]}], "]"}], ";", 
        RowBox[{"edge", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"edge", ",", 
           RowBox[{"{", 
            RowBox[{"DirectedEdge", "[", 
             RowBox[{"v", ",", 
              RowBox[{"RandomChoice", "[", "finallist", "]"}]}], "]"}], 
            "}"}]}], "]"}]}]}]}], "]"}], ";", 
     RowBox[{"NiceGraph", "[", 
      RowBox[{"vert", ",", "edge"}], "]"}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Random3Forest", "[", "n_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "=", "3"}], ";", 
        RowBox[{"vert", "=", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{"n", "-", "1"}]}], "]"}]}], ";", 
        RowBox[{"edge", "=", 
         RowBox[{"{", "}"}]}]}], ",", 
       RowBox[{"v", "<", "n"}], ",", 
       RowBox[{"v", "++"}], ",", 
       RowBox[{
        RowBox[{"PathSoFar", "[", 
         RowBox[{"n", ",", "v", ",", "edge"}], "]"}], ";", 
        RowBox[{"DeleteCasesSuper", "[", 
         RowBox[{"vert", ",", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"{", "v", "}"}], ",", "vl"}], "]"}]}], "]"}], ";", 
        RowBox[{"edge", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"edge", ",", 
           RowBox[{"{", 
            RowBox[{"DirectedEdge", "[", 
             RowBox[{"v", ",", 
              RowBox[{"RandomChoice", "[", "finallist", "]"}]}], "]"}], 
            "}"}]}], "]"}]}]}]}], "]"}], ";", 
     RowBox[{"NiceGraph", "[", 
      RowBox[{"vert", ",", "edge"}], "]"}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DandelionTree", "[", "n_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "=", "2"}], ";", 
        RowBox[{"code", "=", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{
           RowBox[{"n", "-", "1"}], ",", 
           RowBox[{"n", "-", "2"}]}], "]"}]}], ";", 
        RowBox[{"k", "=", 
         RowBox[{"Part", "[", 
          RowBox[{"code", ",", "1"}], "]"}]}], ";", 
        RowBox[{"m", "=", "0"}], ";", 
        RowBox[{"edge", "=", 
         RowBox[{"{", 
          RowBox[{"1", "\[Rule]", "0"}], "}"}]}], ";", 
        RowBox[{"vertices", "=", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{"n", "-", "1"}]}], "]"}]}]}], ",", 
       RowBox[{"i", "<", "n"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"k", "=", 
         RowBox[{"Part", "[", 
          RowBox[{"code", ",", 
           RowBox[{"i", "-", "1"}]}], "]"}]}], ";", 
        RowBox[{"edge", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"edge", ",", 
           RowBox[{"{", 
            RowBox[{"i", "\[Rule]", "k"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"FindCycle", "[", 
             RowBox[{"NiceGraph", "[", 
              RowBox[{"vertices", ",", "edge"}], "]"}], "]"}], "==", 
            RowBox[{"{", "}"}]}], "&&", 
           RowBox[{"k", "\[NotEqual]", "i"}]}], ",", 
          RowBox[{"edge", "=", "edge"}], ",", 
          RowBox[{
           RowBox[{"m", "=", 
            RowBox[{"First", "[", 
             RowBox[{"succ", "[", 
              RowBox[{
               RowBox[{"NiceGraph", "[", 
                RowBox[{"vertices", ",", "edge"}], "]"}], ",", "1"}], "]"}], 
             "]"}]}], ";", 
           RowBox[{"edge", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"edge", ",", 
              RowBox[{"i", "\[Rule]", "k"}]}], "]"}]}], ";", 
           RowBox[{"edge", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"edge", ",", 
              RowBox[{"{", 
               RowBox[{"1", "\[Rule]", "k"}], "}"}]}], "]"}]}], ";", 
           RowBox[{"edge", "=", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"edge", ",", 
              RowBox[{"1", "\[Rule]", "m"}]}], "]"}]}], ";", 
           RowBox[{"edge", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"edge", ",", 
              RowBox[{"{", 
               RowBox[{"i", "\[Rule]", "m"}], "}"}]}], "]"}]}]}]}], "]"}]}]}],
       "]"}], ";", 
     RowBox[{"NiceGraph", "[", 
      RowBox[{"vertices", ",", "edge"}], "]"}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prufer3Forest", "[", "n_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"vertices", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", 
        RowBox[{"n", "-", "1"}]}], "]"}]}], ";", 
     RowBox[{"edge", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"r", "=", 
      RowBox[{"RandomInteger", "[", "2", "]"}]}], ";", 
     RowBox[{"P", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"3", ",", 
        RowBox[{"n", "-", "1"}]}], "]"}]}], ";", 
     RowBox[{"Nu", "=", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"n", "-", "1"}], ",", 
        RowBox[{"n", "-", "4"}]}], "]"}]}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"index", "=", "1"}], ";", 
          RowBox[{"t", "=", "0"}]}], ",", 
         RowBox[{"t", "<", "1"}], ",", 
         RowBox[{"index", "++"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"Nu", ",", 
             RowBox[{"Part", "[", 
              RowBox[{"P", ",", "index"}], "]"}]}], "]"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"edge", "=", "edge"}], ";", 
             RowBox[{"t", "=", "0"}]}], ")"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"edge", "=", 
              RowBox[{"Union", "[", 
               RowBox[{"edge", ",", 
                RowBox[{"{", 
                 RowBox[{"DirectedEdge", "[", 
                  RowBox[{
                   RowBox[{"Part", "[", 
                    RowBox[{"P", ",", "index"}], "]"}], ",", 
                   RowBox[{"First", "[", "Nu", "]"}]}], "]"}], "}"}]}], 
               "]"}]}], ";", 
             RowBox[{"P", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"P", ",", "index"}], "]"}]}], ";", 
             RowBox[{"Nu", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"Nu", ",", "1"}], "]"}]}], ";", 
             RowBox[{"t", "=", "1"}]}], ")"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"step", ",", 
         RowBox[{"n", "-", "4"}]}], "}"}]}], "]"}], ";", 
     RowBox[{"edge", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"edge", ",", 
        RowBox[{"{", 
         RowBox[{"DirectedEdge", "[", 
          RowBox[{
           RowBox[{"First", "[", "P", "]"}], ",", "r"}], "]"}], "}"}]}], 
       "]"}]}], ";", 
     RowBox[{"NiceGraph", "[", 
      RowBox[{"vertices", ",", "edge"}], "]"}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PruferkForest", "[", 
    RowBox[{"n_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"vertices", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", 
        RowBox[{"n", "-", "1"}]}], "]"}]}], ";", 
     RowBox[{"edge", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"r", "=", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"k", "-", "1"}], "]"}]}], ";", 
     RowBox[{"P", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"k", ",", 
        RowBox[{"n", "-", "1"}]}], "]"}]}], ";", 
     RowBox[{"Nu", "=", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"n", "-", "1"}], ",", 
        RowBox[{"n", "-", 
         RowBox[{"(", 
          RowBox[{"k", "+", "1"}], ")"}]}]}], "]"}]}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"index", "=", "1"}], ";", 
          RowBox[{"t", "=", "0"}]}], ",", 
         RowBox[{"t", "<", "1"}], ",", 
         RowBox[{"index", "++"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"Nu", ",", 
             RowBox[{"Part", "[", 
              RowBox[{"P", ",", "index"}], "]"}]}], "]"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"edge", "=", "edge"}], ";", 
             RowBox[{"t", "=", "0"}]}], ")"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"edge", "=", 
              RowBox[{"Union", "[", 
               RowBox[{"edge", ",", 
                RowBox[{"{", 
                 RowBox[{"DirectedEdge", "[", 
                  RowBox[{
                   RowBox[{"Part", "[", 
                    RowBox[{"P", ",", "index"}], "]"}], ",", 
                   RowBox[{"First", "[", "Nu", "]"}]}], "]"}], "}"}]}], 
               "]"}]}], ";", 
             RowBox[{"P", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"P", ",", "index"}], "]"}]}], ";", 
             RowBox[{"Nu", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"Nu", ",", "1"}], "]"}]}], ";", 
             RowBox[{"t", "=", "1"}]}], ")"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"step", ",", 
         RowBox[{"n", "-", 
          RowBox[{"(", 
           RowBox[{"k", "+", "1"}], ")"}]}]}], "}"}]}], "]"}], ";", 
     RowBox[{"edge", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"edge", ",", 
        RowBox[{"{", 
         RowBox[{"DirectedEdge", "[", 
          RowBox[{
           RowBox[{"First", "[", "P", "]"}], ",", "r"}], "]"}], "}"}]}], 
       "]"}]}], ";", 
     RowBox[{"NiceGraph", "[", 
      RowBox[{"vertices", ",", "edge"}], "]"}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OtherRandomForest", "[", 
   RowBox[{"n_", ",", "k_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"vertices", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"0", ",", 
       RowBox[{"n", "-", "1"}]}], "]"}]}], ";", 
    RowBox[{"edge", "=", 
     RowBox[{"{", "}"}]}], ";", 
    RowBox[{"r", "=", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{"k", "-", "1"}], "]"}]}], ";", 
    RowBox[{"P", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"k", ",", 
       RowBox[{"n", "-", "1"}]}], "]"}]}], ";", 
    RowBox[{"Nu", "=", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{
       RowBox[{"n", "-", "1"}], ",", 
       RowBox[{"n", "-", 
        RowBox[{"(", 
         RowBox[{"k", "+", "1"}], ")"}]}]}], "]"}]}], ";", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"index", "=", "1"}], ";", 
         RowBox[{"t", "=", "0"}]}], ",", 
        RowBox[{"t", "<", "1"}], ",", 
        RowBox[{"index", "++"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"Nu", ",", 
            RowBox[{"Part", "[", 
             RowBox[{"P", ",", "index"}], "]"}]}], "]"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"edge", "=", "edge"}], ";", 
            RowBox[{"t", "=", "0"}]}], ")"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"edge", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"edge", ",", 
               RowBox[{"{", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{
                  RowBox[{"Part", "[", 
                   RowBox[{"P", ",", "index"}], "]"}], ",", 
                  RowBox[{"First", "[", "Nu", "]"}]}], "]"}], "}"}]}], 
              "]"}]}], ";", 
            RowBox[{"P", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{"P", ",", "index"}], "]"}]}], ";", 
            RowBox[{"Nu", "=", 
             RowBox[{"Delete", "[", 
              RowBox[{"Nu", ",", "1"}], "]"}]}], ";", 
            RowBox[{"t", "=", "1"}]}], ")"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"step", ",", 
        RowBox[{"n", "-", 
         RowBox[{"(", 
          RowBox[{"k", "+", "1"}], ")"}]}]}], "}"}]}], "]"}], ";", 
    RowBox[{"edge", "=", 
     RowBox[{"Union", "[", 
      RowBox[{"edge", ",", 
       RowBox[{"{", 
        RowBox[{"DirectedEdge", "[", 
         RowBox[{
          RowBox[{"First", "[", "P", "]"}], ",", "r"}], "]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"DirectedEdge", "[", 
         RowBox[{"j", ",", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"k", "-", "1"}], "]"}]}], "]"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"NiceGraph", "[", 
     RowBox[{"vertices", ",", "edge"}], "]"}]}], 
   ")"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7005590496639533`*^9, 3.7005590629681454`*^9}, {
   3.700559099672021*^9, 3.700559251457455*^9}, {3.700559321450947*^9, 
   3.700559405972663*^9}, {3.7005598942707624`*^9, 3.7005599191546865`*^9}, {
   3.700560011072984*^9, 3.7005600475026436`*^9}, {3.7005646359201746`*^9, 
   3.700564672608961*^9}, {3.7005662811568823`*^9, 3.7005662875978336`*^9}, {
   3.7005671291664133`*^9, 3.700567151513558*^9}, {3.700570131069575*^9, 
   3.7005701612141886`*^9}, {3.7005701921322803`*^9, 3.700570214500474*^9}, {
   3.7005702736742306`*^9, 3.700570295679549*^9}, {3.700570407820699*^9, 
   3.7005704417590528`*^9}, {3.7005705014324827`*^9, 3.700570533130789*^9}, {
   3.7005705836221714`*^9, 3.700570584076339*^9}, {3.7005706323560486`*^9, 
   3.700570684408392*^9}, {3.700570909746811*^9, 3.7005709420720396`*^9}, {
   3.7005709845384073`*^9, 3.7005709849861813`*^9}, {3.7005710502913146`*^9, 
   3.7005710506316977`*^9}, {3.700571094059413*^9, 3.7005711119086657`*^9}, {
   3.7005713521501875`*^9, 3.700571376829774*^9}, {3.700571520412264*^9, 
   3.700571552647217*^9}, {3.7005717142972913`*^9, 3.7005717152684608`*^9}, {
   3.700571834753085*^9, 3.7005718378371315`*^9}, {3.7005723785655165`*^9, 
   3.700572405501684*^9}, {3.7005775310670986`*^9, 3.700577532069551*^9}, {
   3.7005775650291147`*^9, 3.700577565916607*^9}, {3.7005776804991007`*^9, 
   3.700577789006296*^9}, {3.7005784268495426`*^9, 3.700578471977148*^9}, {
   3.7005785088179436`*^9, 3.700578514275432*^9}, {3.700578696228074*^9, 
   3.700578711638076*^9}, {3.7005788549812875`*^9, 3.7005788962543383`*^9}, {
   3.7005790704158983`*^9, 3.700579091872998*^9}, {3.7005791527195716`*^9, 
   3.7005791599279113`*^9}, 3.7009102872898235`*^9, {3.7009913977395115`*^9, 
   3.7009914421868534`*^9}, {3.700994416182477*^9, 3.7009944165608563`*^9}, 
   3.7010118513560853`*^9, {3.701606318482174*^9, 3.7016063188799715`*^9}, {
   3.7020369488122897`*^9, 3.7020369496651015`*^9}, 3.7020478339599934`*^9, {
   3.7493977407290382`*^9, 3.7493977947157936`*^9}, {3.7494038325328426`*^9, 
   3.7494039091454973`*^9}, {3.7498151727673235`*^9, 3.749815294378146*^9}, {
   3.7498230570781355`*^9, 3.749823062285962*^9}, {3.749903570774771*^9, 
   3.7499035719659557`*^9}, {3.749903709344189*^9, 3.74990370985979*^9}, {
   3.7501622573509483`*^9, 3.750162294932248*^9}, {3.7501623308183794`*^9, 
   3.750162518128273*^9}, {3.750162675776455*^9, 3.750162678113818*^9}, {
   3.7501628492960033`*^9, 3.7501628546242156`*^9}, {3.7501628952966785`*^9, 
   3.750162895765436*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"d051c5c1-0e12-4696-9b11-f9321b41fc84"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Main Functions", "Section",
 CellChangeTimes->{{3.698664972927446*^9, 3.698664980277646*^9}, {
  3.7005589971590853`*^9, 
  3.700559000854458*^9}},ExpressionUUID->"bd6fc6f5-c27f-437d-bea9-\
f11378336a99"],

Cell[TextData[{
 "\n",
 Cell[BoxData[""], "Input",
  CellChangeTimes->{{3.7005609618677936`*^9, 3.700561004983028*^9}, 
    3.749400318283523*^9},ExpressionUUID->
  "b92f3eaa-ba9c-417a-bb5c-c575c20d0900"]
}], "Subsection",
 CellChangeTimes->{{3.700560095523822*^9, 3.7005601026571245`*^9}, {
  3.7493862957102394`*^9, 3.7493862965135746`*^9}, {3.7494003274822702`*^9, 
  3.749400342678221*^9}},ExpressionUUID->"b61127bf-d676-47a2-999e-\
7b0f3fe8f64b"],

Cell[CellGroupData[{

Cell["Is one a tree and the rest (k+1)-forests?", "Subsection",
 CellChangeTimes->{{3.69866502994809*^9, 3.6986650531712604`*^9}, {
   3.698665104182068*^9, 3.6986651341106873`*^9}, 3.700561085838233*^9, 
   3.7005611388082867`*^9, {3.7494003609936047`*^9, 
   3.7494003742935534`*^9}},ExpressionUUID->"854e78fe-61d4-4e3b-8439-\
0c067fb7f504"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListRoot", "[", "y__", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "=", "1"}], ";", 
        RowBox[{"roots", "=", 
         RowBox[{"{", "}"}]}]}], ",", 
       RowBox[{"i", "<", 
        RowBox[{
         RowBox[{"Length", "[", "y", "]"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "=", "0"}], ";", 
           RowBox[{"rootj", "=", 
            RowBox[{"{", "}"}]}]}], ",", 
          RowBox[{"j", "<", 
           RowBox[{"VertexCount", "[", 
            RowBox[{"y", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"j", "++"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"root", "[", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "j"}], "]"}], ",", 
            RowBox[{"rootj", "=", 
             RowBox[{"Union", "[", 
              RowBox[{"rootj", ",", 
               RowBox[{"{", "j", "}"}]}], "]"}]}], ",", 
            RowBox[{"rootj", "=", "rootj"}]}], "]"}]}], "]"}], ";", 
        RowBox[{"roots", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"roots", ",", "rootj"}], "]"}]}]}]}], "]"}], ";", "roots"}],
     ")"}]}]}]], "Input",
 CellChangeTimes->{
  3.7493878567895985`*^9, {3.7493878942261376`*^9, 3.7493879547527213`*^9}, {
   3.7493879874178*^9, 3.749388037451542*^9}, {3.749394677709587*^9, 
   3.7493946823551645`*^9}, {3.749394713450103*^9, 3.7493948446118455`*^9}, {
   3.74939489432264*^9, 3.749394906673324*^9}, {3.7493951672635813`*^9, 
   3.7493951682010927`*^9}, {3.749395223406814*^9, 3.7493952299380913`*^9}, {
   3.74939532349724*^9, 3.749395324262933*^9}, {3.7493953622120094`*^9, 
   3.749395368729116*^9}, {3.7493954746814146`*^9, 3.749395477745429*^9}, {
   3.7493996825245852`*^9, 3.7493996931155415`*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"101b5d8b-905b-4a74-8c32-ff314c919072"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DMLHS", "[", 
    RowBox[{"x_", ",", "y__"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Nodes", "=", "True"}], ";", 
        RowBox[{"i", "=", "1"}]}], ",", 
       RowBox[{
        RowBox[{"Nodes", "\[Equal]", "True"}], "&&", 
        RowBox[{"i", "<", 
         RowBox[{
          RowBox[{"Length", "[", "y", "]"}], "+", "1"}]}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"VertexCount", "[", "x", "]"}], "\[Equal]", 
          RowBox[{"VertexCount", "[", 
           RowBox[{"y", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"Nodes", "=", "Nodes"}], ",", 
         RowBox[{"Nodes", "=", "False"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Forest", "=", "True"}], ";", 
        RowBox[{"i", "=", "1"}]}], ",", 
       RowBox[{
        RowBox[{"Forest", "\[Equal]", "True"}], "&&", 
        RowBox[{"i", "<", 
         RowBox[{
          RowBox[{"Length", "[", "y", "]"}], "+", "1"}]}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AcyclicGraphQ", "[", 
           RowBox[{"y", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "&&", 
          RowBox[{"outdegree0or1", "[", 
           RowBox[{"y", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"Forest", "=", "Forest"}], ",", 
         RowBox[{"Forest", "=", "False"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"ListRoot", "[", "y", "]"}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"T", "=", "True"}], ";", 
        RowBox[{"i", "=", "1"}]}], ",", 
       RowBox[{
        RowBox[{"T", "\[Equal]", "True"}], "&&", 
        RowBox[{"i", "<", 
         RowBox[{
          RowBox[{"Length", "[", "roots", "]"}], "+", "1"}]}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"roots", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"Length", "[", "y", "]"}], "+", "1"}], "]"}]}], "]"}]}],
          ",", 
         RowBox[{"T", "=", "T"}], ",", 
         RowBox[{"T", "=", "False"}]}], "]"}]}], "]"}], ";", 
     RowBox[{
      RowBox[{"AcyclicGraphQ", "[", "x", "]"}], "&&", 
      RowBox[{"outdegree0or1", "[", "x", "]"}], "&&", 
      RowBox[{"root", "[", 
       RowBox[{"x", ",", "0"}], "]"}], "&&", 
      RowBox[{
       RowBox[{"numroot", "[", "x", "]"}], "\[Equal]", "1"}], "&&", 
      RowBox[{"T", "==", "True"}], "&&", 
      RowBox[{"Forest", "==", "True"}], "&&", 
      RowBox[{"Nodes", "==", "True"}]}]}], ")"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6986651366258407`*^9, 3.6986651366258407`*^9}, 
   3.7005610893834333`*^9, {3.7005613257319727`*^9, 3.7005613437038584`*^9}, {
   3.7005643845778236`*^9, 3.700564455679778*^9}, {3.700564491846811*^9, 
   3.7005645238832884`*^9}, {3.700567058431872*^9, 3.7005670589692025`*^9}, {
   3.7493865828166575`*^9, 3.7493866192713876`*^9}, {3.7493867297831936`*^9, 
   3.749386731380372*^9}, {3.7493868996011076`*^9, 3.7493870392301655`*^9}, {
   3.7493871263960667`*^9, 3.7493873220110617`*^9}, {3.7493873603255434`*^9, 
   3.7493874283225446`*^9}, 3.7493955468550262`*^9, {3.749395609088868*^9, 
   3.7493956885878983`*^9}, {3.749395729618284*^9, 3.7493957782716236`*^9}, {
   3.7493958372358046`*^9, 3.749395876892831*^9}, {3.749396399369529*^9, 
   3.7493965141337967`*^9}, {3.749396562726894*^9, 3.749396646948429*^9}, 
   3.749396721886485*^9, {3.7493982645578938`*^9, 3.7493982669641695`*^9}, {
   3.7493998096840096`*^9, 3.749399847785301*^9}, {3.749399888690694*^9, 
   3.7494001423458185`*^9}, {3.7494002563466625`*^9, 
   3.7494002593105774`*^9}, {3.749400351444015*^9, 3.7494003523033457`*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"27ee17b7-91d2-40b7-b3da-878eafead073"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Are we in S1?", "Subsection",
 CellChangeTimes->{{3.749810253980614*^9, 
  3.7498102576212854`*^9}},ExpressionUUID->"1d47466a-920d-4d9a-83cb-\
cbbaefbe2401"],

Cell[BoxData[
 RowBox[{
  RowBox[{"S1", "[", 
   RowBox[{"x_", ",", "y__"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"ListRoot", "[", "y", "]"}], ";", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"T", "=", "True"}], ";", 
       RowBox[{"i", "=", "1"}]}], ",", 
      RowBox[{
       RowBox[{"T", "\[Equal]", "True"}], "&&", 
       RowBox[{"i", "<", 
        RowBox[{
         RowBox[{"Length", "[", "roots", "]"}], "+", "1"}]}]}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"roots", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Length", "[", "y", "]"}], "+", "1"}], "]"}]}], "]"}]}], 
        ",", 
        RowBox[{"T", "=", "T"}], ",", 
        RowBox[{"T", "=", "False"}]}], "]"}]}], "]"}], ";", 
    RowBox[{
     RowBox[{"root", "[", 
      RowBox[{"x", ",", "0"}], "]"}], "&&", 
     RowBox[{
      RowBox[{"numroot", "[", "x", "]"}], "\[Equal]", "1"}], "&&", 
     RowBox[{"T", "==", "True"}]}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.749810264769348*^9, 3.7498103290357337`*^9}, 
   3.749810442367004*^9, {3.749810483016619*^9, 3.7498104894101725`*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"95edccaf-71c7-4646-ad49-276a4ba606c1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Are they acceptable sets of k-forests?", "Subsection",
 CellChangeTimes->{{3.6986651501209764`*^9, 3.6986651596472936`*^9}, 
   3.700561097659435*^9, 3.700564582575466*^9, {3.749403000653472*^9, 
   3.749403002309743*^9}, {3.7494050576246204`*^9, 3.749405109077109*^9}, {
   3.749405183773302*^9, 3.749405186121691*^9}, {3.749467607645157*^9, 
   3.7494676156922045`*^9}},ExpressionUUID->"6d7c2447-7369-4730-80e8-\
c1b1c8237a58"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DMRHS", "[", 
   RowBox[{"x_", ",", "y__"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Nodes", "=", "True"}], ";", 
       RowBox[{"i", "=", "1"}]}], ",", 
      RowBox[{
       RowBox[{"Nodes", "\[Equal]", "True"}], "&&", 
       RowBox[{"i", "<", 
        RowBox[{
         RowBox[{"Length", "[", "y", "]"}], "+", "1"}]}]}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"VertexCount", "[", "x", "]"}], "\[Equal]", 
         RowBox[{"VertexCount", "[", 
          RowBox[{"y", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"Nodes", "=", "Nodes"}], ",", 
        RowBox[{"Nodes", "=", "False"}]}], "]"}]}], "]"}], ";", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Forest", "=", "True"}], ";", 
       RowBox[{"i", "=", "1"}]}], ",", 
      RowBox[{
       RowBox[{"Forest", "\[Equal]", "True"}], "&&", 
       RowBox[{"i", "<", 
        RowBox[{
         RowBox[{"Length", "[", "y", "]"}], "+", "1"}]}]}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"AcyclicGraphQ", "[", 
          RowBox[{"y", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "&&", 
         RowBox[{"outdegree0or1", "[", 
          RowBox[{"y", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"Forest", "=", "Forest"}], ",", 
        RowBox[{"Forest", "=", "False"}]}], "]"}]}], "]"}], ";", 
    RowBox[{"ListRoot", "[", "y", "]"}], ";", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"T", "=", "True"}], ";", 
       RowBox[{"i", "=", "1"}]}], ",", 
      RowBox[{
       RowBox[{"T", "\[Equal]", "True"}], "&&", 
       RowBox[{"i", "<", 
        RowBox[{
         RowBox[{"Length", "[", "roots", "]"}], "+", "1"}]}]}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"roots", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{
               RowBox[{"Length", "[", "y", "]"}], "+", "1"}], "]"}]}], "]"}], 
           ",", "i"}], "]"}]}], ",", 
        RowBox[{"T", "=", "T"}], ",", 
        RowBox[{"T", "=", "False"}]}], "]"}]}], "]"}], ";", 
    RowBox[{"FForest", "=", "True"}], ";", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"j", "=", "0"}], ";", 
       RowBox[{"rootj", "=", 
        RowBox[{"{", "}"}]}]}], ",", 
      RowBox[{"j", "<", 
       RowBox[{"VertexCount", "[", "x", "]"}]}], ",", 
      RowBox[{"j", "++"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"root", "[", 
         RowBox[{"x", ",", "j"}], "]"}], ",", 
        RowBox[{"rootj", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"rootj", ",", 
           RowBox[{"{", "j", "}"}]}], "]"}]}], ",", 
        RowBox[{"rootj", "=", "rootj"}]}], "]"}]}], "]"}], ";", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"rootj", "\[Equal]", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Length", "[", "y", "]"}], "+", "1"}], "]"}]}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{"Length", "[", "y", "]"}], "+", "1"}]}], "]"}]}], ",", 
      RowBox[{"FForest", "=", "FForest"}], ",", 
      RowBox[{"FForest", "=", "False"}]}], "]"}], ";", 
    RowBox[{
     RowBox[{"AcyclicGraphQ", "[", "x", "]"}], "&&", 
     RowBox[{"outdegree0or1", "[", "x", "]"}], "&&", 
     RowBox[{"T", "==", "True"}], "&&", 
     RowBox[{"Forest", "==", "True"}], "&&", 
     RowBox[{"Nodes", "==", "True"}], "&&", 
     RowBox[{"FForest", "\[Equal]", "True"}], "&&", 
     RowBox[{"!", 
      RowBox[{"BadForests", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}]}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.749405182054476*^9, 3.7494051903133907`*^9}, {
  3.7494053237060723`*^9, 3.7494053952225137`*^9}, {3.749405431351949*^9, 
  3.749405451717429*^9}, {3.7494054960288887`*^9, 3.7494057069724636`*^9}, {
  3.749467213674568*^9, 3.749467224154893*^9}, {3.749467503972394*^9, 
  3.749467521294647*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"e535c2ad-c642-4251-a8a9-578bbf77532a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Are there meta-cycles?", "Subsection",
 CellChangeTimes->{{3.698665252395567*^9, 3.6986652703881383`*^9}, 
   3.700566884389189*^9, {3.749403005045788*^9, 3.7494030051864624`*^9}, {
   3.7494030356505394`*^9, 3.7494030385411453`*^9}, {3.7494045501982574`*^9, 
   3.7494045540178814`*^9}},ExpressionUUID->"80c6e2c7-20e4-45b8-ab0d-\
db1dd2df2350"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"BadForests", "[", 
    RowBox[{"x_", ",", "y__"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"metaedges", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ",", 
       RowBox[{"i", "<", 
        RowBox[{
         RowBox[{"Length", "[", "y", "]"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"pointsto", "[", 
          RowBox[{"x", ",", 
           RowBox[{
            RowBox[{"Length", "[", "y", "]"}], "+", "1"}], ",", "i"}], "]"}], 
         ",", 
         RowBox[{"metaedges", "=", 
          RowBox[{"Union", "[", 
           RowBox[{"metaedges", ",", 
            RowBox[{"{", 
             RowBox[{"DirectedEdge", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", "y", "]"}], "+", "1"}], ",", "i"}], 
              "]"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"metaedges", "=", "metaedges"}]}], "]"}]}], "]"}], ";", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<", 
        RowBox[{
         RowBox[{"Length", "[", "y", "]"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "0"}], ",", 
         RowBox[{"j", "<", 
          RowBox[{
           RowBox[{"Length", "[", "y", "]"}], "+", "2"}]}], ",", 
         RowBox[{"j", "++"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"j", "\[NotEqual]", "i"}], "&&", 
            RowBox[{"pointsto", "[", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "i", ",", "j"}], "]"}]}], 
           ",", 
           RowBox[{"metaedges", "=", 
            RowBox[{"Union", "[", 
             RowBox[{"metaedges", ",", 
              RowBox[{"{", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"i", ",", "j"}], "]"}], "}"}]}], "]"}]}], ",", 
           RowBox[{"metaedges", "=", "metaedges"}]}], "]"}]}], "]"}]}], "]"}],
      ";", 
     RowBox[{
      RowBox[{"FindCycle", "[", 
       RowBox[{"NiceGraph", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{
            RowBox[{"VertexCount", "[", "x", "]"}], "-", "1"}]}], "]"}], ",", 
         "metaedges"}], "]"}], "]"}], "!=", 
      RowBox[{"{", "}"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.6986653066556005`*^9, 3.698665324256181*^9}, {
  3.700566890299917*^9, 3.700566989720994*^9}, {3.7494030420645065`*^9, 
  3.74940309978749*^9}, {3.7494031870850363`*^9, 3.7494033153891573`*^9}, {
  3.749403352669573*^9, 3.749403469799865*^9}, {3.7494035007048664`*^9, 
  3.749403662377309*^9}, {3.7494041429151983`*^9, 3.7494041432901745`*^9}, {
  3.749404261330203*^9, 3.7494042659141273`*^9}, {3.7494043093507743`*^9, 
  3.749404316683422*^9}, {3.7494045686580057`*^9, 3.749404631875182*^9}, {
  3.7494047145726023`*^9, 3.749404714728854*^9}, {3.74940483509907*^9, 
  3.7494048400482955`*^9}, {3.7494049945941305`*^9, 3.749404996390972*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"f3ffe2bd-6a5f-4e41-bdc7-d832c5f117f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Are we in S2?", "Subsection",
 CellChangeTimes->{{3.7498105191311593`*^9, 
  3.749810522891841*^9}},ExpressionUUID->"42dc2f6d-7ccc-4eb5-899e-\
d8a205575486"],

Cell[BoxData[
 RowBox[{
  RowBox[{"S2", "[", 
   RowBox[{"x_", ",", "y__"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"ListRoot", "[", "y", "]"}], ";", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"T", "=", "True"}], ";", 
       RowBox[{"i", "=", "1"}]}], ",", 
      RowBox[{
       RowBox[{"T", "\[Equal]", "True"}], "&&", 
       RowBox[{"i", "<", 
        RowBox[{
         RowBox[{"Length", "[", "roots", "]"}], "+", "1"}]}]}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"roots", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"Range", "[", 
              RowBox[{
               RowBox[{"Length", "[", "y", "]"}], "+", "1"}], "]"}]}], "]"}], 
           ",", "i"}], "]"}]}], ",", 
        RowBox[{"T", "=", "T"}], ",", 
        RowBox[{"T", "=", "False"}]}], "]"}]}], "]"}], ";", 
    RowBox[{"FForest", "=", "True"}], ";", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"j", "=", "0"}], ";", 
       RowBox[{"rootj", "=", 
        RowBox[{"{", "}"}]}]}], ",", 
      RowBox[{"j", "<", 
       RowBox[{"VertexCount", "[", "x", "]"}]}], ",", 
      RowBox[{"j", "++"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"root", "[", 
         RowBox[{"x", ",", "j"}], "]"}], ",", 
        RowBox[{"rootj", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"rootj", ",", 
           RowBox[{"{", "j", "}"}]}], "]"}]}], ",", 
        RowBox[{"rootj", "=", "rootj"}]}], "]"}]}], "]"}], ";", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"rootj", "\[Equal]", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"Length", "[", "y", "]"}], "+", "1"}], "]"}]}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{"Length", "[", "y", "]"}], "+", "1"}]}], "]"}]}], ",", 
      RowBox[{"FForest", "=", "FForest"}], ",", 
      RowBox[{"FForest", "=", "False"}]}], "]"}], ";", 
    RowBox[{
     RowBox[{"T", "\[Equal]", "True"}], "&&", 
     RowBox[{"FForest", "\[Equal]", "True"}]}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.7498105717862916`*^9, 3.7498105824438925`*^9}, {
  3.749810628212296*^9, 3.749810657492816*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"27785a04-2068-4671-a26f-a47f7026571b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Are the k graphs forests of the appropriate kind?", "Subsection",
 CellChangeTimes->{{3.698753892994501*^9, 3.6987539254650545`*^9}, 
   3.7005670139157095`*^9, {3.7494676323074465`*^9, 
   3.749467633325774*^9}},ExpressionUUID->"c1da5047-01ee-4fc9-9a36-\
79d034393ec4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Appropriate", "[", 
   RowBox[{"x_", ",", "y__"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"DMLHS", "[", 
    RowBox[{"x", ",", "y"}], "]"}], "||", 
   RowBox[{"DMRHS", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7005670210166583`*^9, 3.7005670946862416`*^9}, {
  3.7009070542099047`*^9, 3.7009070720368285`*^9}, {3.7494676435632634`*^9, 
  3.7494676959106655`*^9}, {3.7494677587533956`*^9, 3.7494677627555723`*^9}, {
  3.749467815001999*^9, 3.7494678167364473`*^9}, {3.7494678571505604`*^9, 
  3.749467860965658*^9}, {3.7494679061903143`*^9, 3.7494679097878094`*^9}, {
  3.7494679494006777`*^9, 3.7494680486690917`*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"16962fcb-b041-4e86-8d92-6e16698de399"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Highlighting the appropriate cycle (if there is one) or changing the color of \
meta-edges\
\>", "Subsection",
 CellChangeTimes->{{3.698665332431614*^9, 3.6986653609745617`*^9}, {
  3.7005707230437145`*^9, 
  3.700570732859806*^9}},ExpressionUUID->"f1dab67f-ab5f-4f25-9ce6-\
044ca74ff1cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"genphi0", "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", "y__"}], "}"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"DMLHS", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], ",", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"tau", "=", "1"}], ";", 
         RowBox[{"cycle", "=", "0"}], ";", 
         RowBox[{"newy", "=", 
          RowBox[{"{", "}"}]}]}], ",", 
        RowBox[{
         RowBox[{"cycle", "\[Equal]", "0"}], "&&", 
         RowBox[{"tau", "<", 
          RowBox[{
           RowBox[{"Length", "[", "y", "]"}], "+", "1"}]}]}], ",", 
        RowBox[{"tau", "++"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AcyclicGraphQ", "[", 
           RowBox[{"y", "[", 
            RowBox[{"[", "tau", "]"}], "]"}], "]"}], ",", 
          RowBox[{"newy", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"newy", ",", 
             RowBox[{"y", "[", 
              RowBox[{"[", "tau", "]"}], "]"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"newy", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"newy", ",", 
              RowBox[{"HighestCycle", "[", 
               RowBox[{"y", "[", 
                RowBox[{"[", "tau", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
           RowBox[{"cycle", "=", "1"}]}]}], "]"}]}], "]"}], ";", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"rest", "=", "tau"}], ",", 
        RowBox[{"rest", "<", 
         RowBox[{
          RowBox[{"Length", "[", "y", "]"}], "+", "1"}]}], ",", 
        RowBox[{"rest", "++"}], ",", 
        RowBox[{"newy", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"newy", ",", 
           RowBox[{"y", "[", 
            RowBox[{"[", "rest", "]"}], "]"}]}], "]"}]}]}], "]"}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"cycle", "\[Equal]", "0"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"AcyclicGraphQ", "[", "x", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"HighestCycle", "[", "x", "]"}], ",", "newy"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "newy"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "newy"}], "}"}]}], "]"}]}], ")"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.700570719884756*^9, 3.700571323557891*^9, {3.7495578822358336`*^9, 
   3.7495580131515074`*^9}, {3.7495580681572804`*^9, 
   3.7495581585864654`*^9}, {3.7495582876945906`*^9, 3.749558405358551*^9}, {
   3.7495584741940107`*^9, 3.749558542617174*^9}, {3.7495585802900867`*^9, 
   3.7495585933220673`*^9}, {3.7495587022674437`*^9, 
   3.7495587029705777`*^9}, {3.749559155646123*^9, 3.7495593930978794`*^9}, {
   3.749559424988658*^9, 3.749559436316924*^9}, {3.7495596053215284`*^9, 
   3.7495596341798167`*^9}, {3.749559665894085*^9, 3.7495596819103155`*^9}, {
   3.749559720381085*^9, 3.749559720537362*^9}, {3.749559790721026*^9, 
   3.7495598319592595`*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"ba5bc063-27ee-4651-b6ad-400d9a9acf59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"genphi2", "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", "y__"}], "}"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"DMRHS", "[", 
     RowBox[{"x", ",", "y"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"(", 
        RowBox[{"Forest", "&&", 
         RowBox[{"AcyclicGraphQ", "[", "x", "]"}]}], ")"}]}], ",", 
      RowBox[{"genphi0", "[", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}], "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"BadForests", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", 
        RowBox[{
         RowBox[{"max", "=", 
          RowBox[{"MaxCycle", "[", 
           RowBox[{"NiceGraph", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"VertexCount", "[", "x", "]"}], "-", "1"}]}], "]"}], 
             ",", "metaedges"}], "]"}], "]"}]}], ";", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"theta", "=", "1"}], ";", 
            RowBox[{"newy", "=", 
             RowBox[{"{", "}"}]}]}], ",", 
           RowBox[{"theta", "<", 
            RowBox[{
             RowBox[{"Length", "[", "y", "]"}], "+", "1"}]}], ",", 
           RowBox[{"theta", "++"}], ",", 
           RowBox[{
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"end", "=", "0"}], ";", 
               RowBox[{"appedge", "=", "0"}]}], ",", 
              RowBox[{"end", "<", 
               RowBox[{
                RowBox[{"Length", "[", "y", "]"}], "+", "2"}]}], ",", 
              RowBox[{"end", "++"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"end", "\[NotEqual]", "theta"}], "&&", 
                 RowBox[{"pointsto", "[", 
                  RowBox[{
                   RowBox[{"y", "[", 
                    RowBox[{"[", "theta", "]"}], "]"}], ",", "theta", ",", 
                   "end"}], "]"}]}], ",", 
                RowBox[{"appedge", "=", 
                 RowBox[{"DirectedEdge", "[", 
                  RowBox[{"theta", ",", "end"}], "]"}]}], ",", 
                RowBox[{"appedge", "=", "appedge"}]}], "]"}]}], "]"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"max", ",", "appedge"}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"IsRed", "[", 
                 RowBox[{
                  RowBox[{"y", "[", 
                   RowBox[{"[", "theta", "]"}], "]"}], ",", "theta"}], "]"}], 
                ",", 
                RowBox[{"newy", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{"newy", ",", 
                   RowBox[{"TurnBlack", "[", 
                    RowBox[{
                    RowBox[{"y", "[", 
                    RowBox[{"[", "theta", "]"}], "]"}], ",", 
                    RowBox[{"SpanningTree", "[", 
                    RowBox[{
                    RowBox[{"y", "[", 
                    RowBox[{"[", "theta", "]"}], "]"}], ",", "theta"}], 
                    "]"}]}], "]"}]}], "]"}]}], ",", 
                RowBox[{"newy", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{"newy", ",", 
                   RowBox[{"TurnRed", "[", 
                    RowBox[{
                    RowBox[{"y", "[", 
                    RowBox[{"[", "theta", "]"}], "]"}], ",", 
                    RowBox[{"SpanningTree", "[", 
                    RowBox[{
                    RowBox[{"y", "[", 
                    RowBox[{"[", "theta", "]"}], "]"}], ",", "theta"}], 
                    "]"}]}], "]"}]}], "]"}]}]}], "]"}], ",", 
              RowBox[{"newy", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"newy", ",", 
                 RowBox[{"y", "[", 
                  RowBox[{"[", "theta", "]"}], "]"}]}], "]"}]}]}], "]"}]}]}], 
          "]"}], ";", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"end", "=", "0"}], ";", 
            RowBox[{"appedgex", "=", "0"}]}], ",", 
           RowBox[{"end", "<", 
            RowBox[{
             RowBox[{"Length", "[", "y", "]"}], "+", "1"}]}], ",", 
           RowBox[{"end", "++"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"pointsto", "[", 
              RowBox[{"x", ",", 
               RowBox[{
                RowBox[{"Length", "[", "y", "]"}], "+", "1"}], ",", "end"}], 
              "]"}], ",", 
             RowBox[{"appedgex", "=", 
              RowBox[{"DirectedEdge", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "y", "]"}], "+", "1"}], ",", "end"}], 
               "]"}]}], ",", 
             RowBox[{"appedgex", "=", "appedgex"}]}], "]"}]}], "]"}], ";", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"max", ",", "appedgex"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"IsRed", "[", 
              RowBox[{"x", ",", 
               RowBox[{
                RowBox[{"Length", "[", "y", "]"}], "+", "1"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"TurnBlack", "[", 
                RowBox[{"x", ",", 
                 RowBox[{"SpanningTree", "[", 
                  RowBox[{"x", ",", 
                   RowBox[{
                    RowBox[{"Length", "[", "y", "]"}], "+", "1"}]}], "]"}]}], 
                "]"}], ",", "newy"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"TurnRed", "[", 
                RowBox[{"x", ",", 
                 RowBox[{"SpanningTree", "[", 
                  RowBox[{"x", ",", 
                   RowBox[{
                    RowBox[{"Length", "[", "y", "]"}], "+", "1"}]}], "]"}]}], 
                "]"}], ",", "newy"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "newy"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.698665396477934*^9, 3.6986654082070184`*^9}, {
   3.69875661780729*^9, 3.698756624472707*^9}, {3.700570729220693*^9, 
   3.700570752011017*^9}, 3.7005725898043165`*^9, {3.749560011766941*^9, 
   3.7495600176577005`*^9}, {3.749560234087042*^9, 3.749560259888228*^9}, {
   3.749560295993209*^9, 3.749560309211296*^9}, {3.74956034212444*^9, 
   3.7495603459057817`*^9}, {3.7495604646668105`*^9, 
   3.7495604701512327`*^9}, {3.749560684822631*^9, 3.7495607500812283`*^9}, {
   3.749560784582239*^9, 3.7495608193444786`*^9}, {3.749560887114286*^9, 
   3.7495609003383512`*^9}, {3.749565648868846*^9, 3.7495656882927876`*^9}, {
   3.749565855409891*^9, 3.749565938295683*^9}, {3.7495659743660374`*^9, 
   3.7495659753660507`*^9}, {3.749566093748275*^9, 3.7495662649477406`*^9}, {
   3.749566300604932*^9, 3.749566372800711*^9}, {3.749566422007325*^9, 
   3.74956643777962*^9}, {3.749566577782467*^9, 3.7495666436951656`*^9}, {
   3.7495667663450823`*^9, 3.749566771501428*^9}, {3.7495668021431794`*^9, 
   3.749567012066081*^9}, {3.749567268364623*^9, 3.7495672685677757`*^9}, {
   3.749567900420153*^9, 3.7495679032483425`*^9}, {3.749567936311081*^9, 
   3.7495680023896627`*^9}, {3.7495680344466076`*^9, 
   3.7495680719627047`*^9}, {3.749568121163509*^9, 3.749568129355513*^9}, {
   3.7495682209228787`*^9, 3.749568230370962*^9}, {3.749568384992528*^9, 
   3.7495683873988676`*^9}, 3.7495689838644667`*^9, {3.7495690340440464`*^9, 
   3.749569045971713*^9}, {3.7498042899745445`*^9, 3.7498042980982065`*^9}, {
   3.7498043309729257`*^9, 3.7498043345134816`*^9}, {3.7498043760253057`*^9, 
   3.7498043857807755`*^9}, {3.7498051020508766`*^9, 3.749805116323536*^9}, {
   3.749805278125063*^9, 3.7498052814532843`*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"762cd5e6-33d8-48d1-a9e1-b66afd69ed8b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Moves an edge coming out of node i from x to y or vice versa, or a specified \
edge (inputted DirectedEdge[i,j])\
\>", "Subsection",
 CellChangeTimes->{
  3.7005805545596933`*^9},ExpressionUUID->"e200c4ae-2785-4a39-a0f0-\
0aa548b404da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x2y", "[", 
   RowBox[{"x_", ",", "y_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"IsRed", "[", 
     RowBox[{"x", ",", "i"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x", "]"}], ",", 
          RowBox[{"Deletei", "[", 
           RowBox[{"x", ",", 
            RowBox[{"EdgeList", "[", "x", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Deletei", "[", 
         RowBox[{"x", ",", 
          RowBox[{"RedEdges", "[", "x", "]"}], ",", "i"}], "]"}]}], "]"}], 
      ",", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"Addi", "[", 
           RowBox[{"x", ",", 
            RowBox[{"EdgeList", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Addi", "[", 
         RowBox[{"x", ",", 
          RowBox[{"RedEdges", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x", "]"}], ",", 
          RowBox[{"Deletei", "[", 
           RowBox[{"x", ",", 
            RowBox[{"EdgeList", "[", "x", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Deletei", "[", 
         RowBox[{"x", ",", 
          RowBox[{"RedEdges", "[", "x", "]"}], ",", "i"}], "]"}]}], "]"}], 
      ",", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"Addi", "[", 
           RowBox[{"x", ",", 
            RowBox[{"EdgeList", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"RedEdges", "[", "y", "]"}]}], "]"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6986654578023233`*^9, 3.6986654759362864`*^9}, 
   3.6986671309080877`*^9, 3.6987526303175554`*^9, 3.698753137589508*^9, {
   3.698756629496007*^9, 3.6987566301391525`*^9}, {3.7005671238383007`*^9, 
   3.700567145315336*^9}, {3.7005671922733345`*^9, 3.700567198539288*^9}, 
   3.7005707398467407`*^9, {3.700571196594368*^9, 3.7005712468881598`*^9}, 
   3.700571318379902*^9, {3.7005714166305428`*^9, 3.70057142313443*^9}, {
   3.7005714717915354`*^9, 3.700571473051661*^9}, {3.700571588365794*^9, 
   3.7005715918463335`*^9}, {3.7005718512575493`*^9, 
   3.7005718545419245`*^9}, {3.7005719150145493`*^9, 3.7005719332833166`*^9}, 
   3.7005719897137666`*^9, {3.7005720603421073`*^9, 3.7005720958044205`*^9}, {
   3.7005721308113365`*^9, 3.7005721588924885`*^9}, {3.700572196308391*^9, 
   3.700572199645521*^9}, {3.700572232570962*^9, 3.7005722387371387`*^9}, {
   3.700572277600705*^9, 3.7005723375726585`*^9}, {3.7005724444277077`*^9, 
   3.700572546632223*^9}, 3.700572586316552*^9, 3.700580532334691*^9, {
   3.7005805655882063`*^9, 3.7005805874858136`*^9}, 3.7009103863714037`*^9},
 CellLabel->
  "In[154]:=",ExpressionUUID->"61111c5f-374d-4f35-973a-f2059c51dbfe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"y2x", "[", 
   RowBox[{"x_", ",", "y_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"IsRed", "[", 
     RowBox[{"y", ",", "i"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x", "]"}], ",", 
          RowBox[{"Addi", "[", 
           RowBox[{"y", ",", 
            RowBox[{"EdgeList", "[", "x", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Addi", "[", 
         RowBox[{"y", ",", 
          RowBox[{"RedEdges", "[", "x", "]"}], ",", "i"}], "]"}]}], "]"}], 
      ",", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"Deletei", "[", 
           RowBox[{"y", ",", 
            RowBox[{"EdgeList", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Deletei", "[", 
         RowBox[{"y", ",", 
          RowBox[{"RedEdges", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x", "]"}], ",", 
          RowBox[{"Addi", "[", 
           RowBox[{"y", ",", 
            RowBox[{"EdgeList", "[", "x", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"RedEdges", "[", "x", "]"}]}], "]"}], ",", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"Deletei", "[", 
           RowBox[{"y", ",", 
            RowBox[{"EdgeList", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Deletei", "[", 
         RowBox[{"y", ",", 
          RowBox[{"RedEdges", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}]}], 
     "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6987610771677327`*^9, 3.6987610865358257`*^9}, 
   3.700577521771679*^9, {3.700580598507406*^9, 3.7005805996802697`*^9}, 
   3.7009104052924876`*^9},
 CellLabel->
  "In[155]:=",ExpressionUUID->"c5167f65-1043-447a-a90f-d7de03402334"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x2yEdge", "[", 
   RowBox[{"x_", ",", "y_", ",", "e_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Colored", "[", 
     RowBox[{"x", ",", "e"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x", "]"}], ",", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "x", "]"}], ",", "e"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"RedEdges", "[", "x", "]"}], ",", "e"}], "]"}]}], "]"}], 
      ",", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "y", "]"}], ",", 
            RowBox[{"{", "e", "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"RedEdges", "[", "y", "]"}], ",", 
          RowBox[{"{", "e", "}"}]}], "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x", "]"}], ",", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "x", "]"}], ",", "e"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"RedEdges", "[", "x", "]"}], ",", "e"}], "]"}]}], "]"}], 
      ",", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "y", "]"}], ",", 
            RowBox[{"{", "e", "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"RedEdges", "[", "y", "]"}]}], "]"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{3.700577518862233*^9, 3.700580630967164*^9},
 CellLabel->
  "In[156]:=",ExpressionUUID->"5b49ca4f-66dc-4506-bfd0-f8128f640fd1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"y2xEdge", "[", 
   RowBox[{"x_", ",", "y_", ",", "e_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Colored", "[", 
     RowBox[{"y", ",", "e"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x", "]"}], ",", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "x", "]"}], ",", 
            RowBox[{"{", "e", "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"RedEdges", "[", "x", "]"}], ",", 
          RowBox[{"{", "e", "}"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "y", "]"}], ",", "e"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"RedEdges", "[", "y", "]"}], ",", "e"}], "]"}]}], "]"}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x", "]"}], ",", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "x", "]"}], ",", 
            RowBox[{"{", "e", "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"RedEdges", "[", "x", "]"}]}], "]"}], ",", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "y", "]"}], ",", "e"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"RedEdges", "[", "y", "]"}], ",", "e"}], "]"}]}], "]"}]}], 
     "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6998903260715113`*^9, 3.6998903354793873`*^9}, 
   3.700577546960593*^9, {3.7005806528231134`*^9, 3.7005806538152504`*^9}, {
   3.700911455066657*^9, 3.7009114554664927`*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"4e923679-9519-42ce-9b4f-982adcf03f3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x2ydouble", "[", 
   RowBox[{"x_", ",", "y_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"IsRed", "[", 
     RowBox[{"x", ",", "i"}], "]"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"IsRed", "[", 
       RowBox[{"y", ",", "i"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TurnRed", "[", 
         RowBox[{
          RowBox[{"NiceGraph", "[", 
           RowBox[{
            RowBox[{"VertexList", "[", "x", "]"}], ",", 
            RowBox[{"EdgeList", "[", "x", "]"}]}], "]"}], ",", 
          RowBox[{"Deletei", "[", 
           RowBox[{"x", ",", 
            RowBox[{"RedEdges", "[", "x", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"TurnRed", "[", 
         RowBox[{
          RowBox[{"NiceGraph", "[", 
           RowBox[{
            RowBox[{"VertexList", "[", "y", "]"}], ",", 
            RowBox[{"EdgeList", "[", "y", "]"}]}], "]"}], ",", 
          RowBox[{"Addi", "[", 
           RowBox[{"x", ",", 
            RowBox[{"RedEdges", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}]}],
        "}"}]}], "]"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"IsRed", "[", 
       RowBox[{"y", ",", "i"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TurnRed", "[", 
         RowBox[{
          RowBox[{"NiceGraph", "[", 
           RowBox[{
            RowBox[{"VertexList", "[", "x", "]"}], ",", 
            RowBox[{"EdgeList", "[", "x", "]"}]}], "]"}], ",", 
          RowBox[{"Addi", "[", 
           RowBox[{"y", ",", 
            RowBox[{"RedEdges", "[", "x", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"TurnRed", "[", 
         RowBox[{
          RowBox[{"NiceGraph", "[", 
           RowBox[{
            RowBox[{"VertexList", "[", "y", "]"}], ",", 
            RowBox[{"EdgeList", "[", "y", "]"}]}], "]"}], ",", 
          RowBox[{"Deletei", "[", 
           RowBox[{"y", ",", 
            RowBox[{"RedEdges", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}]}],
        "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[158]:=",ExpressionUUID->"2fcd7ddb-e293-41fa-8017-5d16397cd998"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x2yk", "[", 
   RowBox[{"x0_", ",", "y_", ",", "i_", ",", "bk_", ",", "f2__"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"IsRed", "[", 
     RowBox[{"x0", ",", "i"}], "]"}], ",", 
    RowBox[{
     RowBox[{"x", "=", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x0", "]"}], ",", 
          RowBox[{"Deletei", "[", 
           RowBox[{"x0", ",", 
            RowBox[{"EdgeList", "[", "x0", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Deletei", "[", 
         RowBox[{"x0", ",", 
          RowBox[{"RedEdges", "[", "x0", "]"}], ",", "i"}], "]"}]}], "]"}]}], 
     ";", 
     RowBox[{"y0", "=", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"Addi", "[", 
           RowBox[{"x0", ",", 
            RowBox[{"EdgeList", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Addi", "[", 
         RowBox[{"x0", ",", 
          RowBox[{"RedEdges", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}]}], 
     ";", 
     RowBox[{"newf2", "=", "f2"}], ";", 
     RowBox[{
      RowBox[{"newf2", "[", 
       RowBox[{"[", "bk", "]"}], "]"}], "=", "y0"}], ";", 
     RowBox[{"{", 
      RowBox[{"x", ",", "newf2"}], "}"}]}], ",", 
    RowBox[{
     RowBox[{"x", "=", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x0", "]"}], ",", 
          RowBox[{"Deletei", "[", 
           RowBox[{"x0", ",", 
            RowBox[{"EdgeList", "[", "x0", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Deletei", "[", 
         RowBox[{"x0", ",", 
          RowBox[{"RedEdges", "[", "x0", "]"}], ",", "i"}], "]"}]}], "]"}]}], 
     ";", 
     RowBox[{"y0", "=", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"Addi", "[", 
           RowBox[{"x0", ",", 
            RowBox[{"EdgeList", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"RedEdges", "[", "y", "]"}]}], "]"}]}], ";", 
     RowBox[{"newf2", "=", "f2"}], ";", 
     RowBox[{
      RowBox[{"newf2", "[", 
       RowBox[{"[", "bk", "]"}], "]"}], "=", "y0"}], ";", 
     RowBox[{"{", 
      RowBox[{"x", ",", "newf2"}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.7005775263645277`*^9, {3.7498140538021345`*^9, 3.749814268886438*^9}, {
   3.74991511926952*^9, 3.749915176882596*^9}, {3.7499152418833323`*^9, 
   3.7499152634431925`*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"b32c873c-1578-4b75-b3e9-1d0499d202f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"y2xk", "[", 
   RowBox[{"x0_", ",", "y_", ",", "i_", ",", "bk_", ",", "f2__"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"IsRed", "[", 
     RowBox[{"y", ",", "i"}], "]"}], ",", 
    RowBox[{
     RowBox[{"x", "=", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x0", "]"}], ",", 
          RowBox[{"Addi", "[", 
           RowBox[{"y", ",", 
            RowBox[{"EdgeList", "[", "x0", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Addi", "[", 
         RowBox[{"y", ",", 
          RowBox[{"RedEdges", "[", "x0", "]"}], ",", "i"}], "]"}]}], "]"}]}], 
     ";", 
     RowBox[{"y0", "=", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"Deletei", "[", 
           RowBox[{"y", ",", 
            RowBox[{"EdgeList", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Deletei", "[", 
         RowBox[{"y", ",", 
          RowBox[{"RedEdges", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}]}], 
     ";", 
     RowBox[{"newf2", "=", "f2"}], ";", 
     RowBox[{
      RowBox[{"newf2", "[", 
       RowBox[{"[", "bk", "]"}], "]"}], "=", "y0"}], ";", 
     RowBox[{"{", 
      RowBox[{"x", ",", "newf2"}], "}"}]}], ",", 
    RowBox[{
     RowBox[{"x", "=", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x0", "]"}], ",", 
          RowBox[{"Addi", "[", 
           RowBox[{"y", ",", 
            RowBox[{"EdgeList", "[", "x0", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"RedEdges", "[", "x0", "]"}]}], "]"}]}], ";", 
     RowBox[{"y0", "=", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"Deletei", "[", 
           RowBox[{"y", ",", 
            RowBox[{"EdgeList", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"Deletei", "[", 
         RowBox[{"y", ",", 
          RowBox[{"RedEdges", "[", "y", "]"}], ",", "i"}], "]"}]}], "]"}]}], 
     ";", 
     RowBox[{"newf2", "=", "f2"}], ";", 
     RowBox[{
      RowBox[{"newf2", "[", 
       RowBox[{"[", "bk", "]"}], "]"}], "=", "y0"}], ";", 
     RowBox[{"{", 
      RowBox[{"x", ",", "newf2"}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.749816038446088*^9, 3.7498161793756533`*^9}, {
  3.749816905384884*^9, 3.7498169309805927`*^9}, {3.7498225879680357`*^9, 
  3.7498226181084056`*^9}, {3.749915186173689*^9, 3.7499152244925137`*^9}},
 CellLabel->
  "In[160]:=",ExpressionUUID->"7a81f303-4965-49da-84f8-700d0355441e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x2ykEdge", "[", 
   RowBox[{"x0_", ",", "y_", ",", "e_", ",", "bk_", ",", "f2__"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Colored", "[", 
     RowBox[{"x0", ",", "e"}], "]"}], ",", 
    RowBox[{
     RowBox[{"x", "=", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x0", "]"}], ",", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "x0", "]"}], ",", "e"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"RedEdges", "[", "x0", "]"}], ",", "e"}], "]"}]}], "]"}]}], 
     ";", 
     RowBox[{"y0", "=", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "y", "]"}], ",", 
            RowBox[{"{", "e", "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"RedEdges", "[", "y", "]"}], ",", 
          RowBox[{"{", "e", "}"}]}], "]"}]}], "]"}]}], ";", 
     RowBox[{"newf2", "=", "f2"}], ";", 
     RowBox[{
      RowBox[{"newf2", "[", 
       RowBox[{"[", "bk", "]"}], "]"}], "=", "y0"}], ";", 
     RowBox[{"{", 
      RowBox[{"x", ",", "newf2"}], "}"}]}], ",", 
    RowBox[{
     RowBox[{"x", "=", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "x0", "]"}], ",", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "x0", "]"}], ",", "e"}], "]"}]}], "]"}], 
        ",", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"RedEdges", "[", "x0", "]"}], ",", "e"}], "]"}]}], "]"}]}], 
     ";", 
     RowBox[{"y0", "=", 
      RowBox[{"TurnRed", "[", 
       RowBox[{
        RowBox[{"NiceGraph", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "y", "]"}], ",", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"EdgeList", "[", "y", "]"}], ",", 
            RowBox[{"{", "e", "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"RedEdges", "[", "y", "]"}]}], "]"}]}], ";", 
     RowBox[{"newf2", "=", "f2"}], ";", 
     RowBox[{
      RowBox[{"newf2", "[", 
       RowBox[{"[", "bk", "]"}], "]"}], "=", "y0"}], ";", 
     RowBox[{"{", 
      RowBox[{"x", ",", "newf2"}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7499128880211496`*^9, 3.7499130026139045`*^9}, {
  3.749915230851942*^9, 3.749915234961397*^9}, {3.749915274690242*^9, 
  3.7499153074766703`*^9}},
 CellLabel->
  "In[161]:=",ExpressionUUID->"39d40393-ed04-4876-92e7-d64c0413120d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"x2ydoublek", "[", 
   RowBox[{"x0_", ",", "y_", ",", "i_", ",", "bk_", ",", "f2_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"x", "=", "x0"}], ";", 
    RowBox[{"newf2", "=", "f2"}], ";", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"IsRed", "[", 
       RowBox[{"x0", ",", "i"}], "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"IsRed", "[", 
         RowBox[{"y", ",", "i"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "newf2"}], "}"}], ",", 
        RowBox[{
         RowBox[{"x", "=", 
          RowBox[{"TurnRed", "[", 
           RowBox[{
            RowBox[{"NiceGraph", "[", 
             RowBox[{
              RowBox[{"VertexList", "[", "x0", "]"}], ",", 
              RowBox[{"EdgeList", "[", "x0", "]"}]}], "]"}], ",", 
            RowBox[{"Deletei", "[", 
             RowBox[{"x0", ",", 
              RowBox[{"RedEdges", "[", "x0", "]"}], ",", "i"}], "]"}]}], 
           "]"}]}], ";", 
         RowBox[{"y0", "=", 
          RowBox[{"TurnRed", "[", 
           RowBox[{
            RowBox[{"NiceGraph", "[", 
             RowBox[{
              RowBox[{"VertexList", "[", "y", "]"}], ",", 
              RowBox[{"EdgeList", "[", "y", "]"}]}], "]"}], ",", 
            RowBox[{"Addi", "[", 
             RowBox[{"x0", ",", 
              RowBox[{"RedEdges", "[", "y", "]"}], ",", "i"}], "]"}]}], 
           "]"}]}], ";", 
         RowBox[{
          RowBox[{"newf2", "[", 
           RowBox[{"[", "bk", "]"}], "]"}], "=", "y0"}], ";", 
         RowBox[{"{", 
          RowBox[{"x", ",", "newf2"}], "}"}]}]}], "]"}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"IsRed", "[", 
         RowBox[{"y", ",", "i"}], "]"}], ",", 
        RowBox[{
         RowBox[{"x", "=", 
          RowBox[{"TurnRed", "[", 
           RowBox[{
            RowBox[{"NiceGraph", "[", 
             RowBox[{
              RowBox[{"VertexList", "[", "x0", "]"}], ",", 
              RowBox[{"EdgeList", "[", "x0", "]"}]}], "]"}], ",", 
            RowBox[{"Addi", "[", 
             RowBox[{"y", ",", 
              RowBox[{"RedEdges", "[", "x0", "]"}], ",", "i"}], "]"}]}], 
           "]"}]}], ";", 
         RowBox[{"y0", "=", 
          RowBox[{"TurnRed", "[", 
           RowBox[{
            RowBox[{"NiceGraph", "[", 
             RowBox[{
              RowBox[{"VertexList", "[", "y", "]"}], ",", 
              RowBox[{"EdgeList", "[", "y", "]"}]}], "]"}], ",", 
            RowBox[{"Deletei", "[", 
             RowBox[{"y", ",", 
              RowBox[{"RedEdges", "[", "y", "]"}], ",", "i"}], "]"}]}], 
           "]"}]}], ";", 
         RowBox[{
          RowBox[{"newf2", "[", 
           RowBox[{"[", "bk", "]"}], "]"}], "=", "y0"}], ";", 
         RowBox[{"{", 
          RowBox[{"x", ",", "newf2"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "newf2"}], "}"}]}], "]"}]}], "]"}]}], 
   ")"}]}]], "Input",
 CellChangeTimes->{{3.750169174707087*^9, 3.750169388927738*^9}, {
  3.7501694493849506`*^9, 3.7501695076532173`*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"612cb631-eb26-4cfd-acd9-4604bf459c41"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "Subsection",
 CellChangeTimes->{{3.6999534491894245`*^9, 3.6999534617865334`*^9}, 
   3.700577553579844*^9},ExpressionUUID->"7cd229d3-1da3-44be-83a6-\
6b646d299e81"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.7005775502961164`*^9},
 CellLabel->
  "In[163]:=",ExpressionUUID->"937082bb-92c8-495a-89e7-c961fc23f599"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "Subsection",
 CellChangeTimes->{{3.6999534907540274`*^9, 3.699953498584552*^9}, 
   3.7005775732213397`*^9},ExpressionUUID->"a00522ce-4a14-4c4c-b05b-\
f3c362c5ecce"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.700392627341243*^9, 3.7005775604517274`*^9},
 CellLabel->
  "In[164]:=",ExpressionUUID->"2705aabd-572b-438d-ba8e-2336900ba470"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "Subsection",
 CellChangeTimes->{{3.6999575450309443`*^9, 3.699957562438466*^9}, {
   3.699974711899658*^9, 3.699974737264982*^9}, 
   3.700580515475171*^9},ExpressionUUID->"41ed6071-92f6-4dca-b3ca-\
239e3a8d802f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6999580698593793`*^9, 3.6999580708361273`*^9}, {
   3.699974740404091*^9, 3.69997476675657*^9}, {3.700578308430024*^9, 
   3.7005783324761906`*^9}, {3.700578566604467*^9, 3.7005785698341618`*^9}, {
   3.700578650655116*^9, 3.700578658804418*^9}, {3.7005787533292065`*^9, 
   3.700578804765317*^9}, {3.700578940795519*^9, 3.7005789813596478`*^9}, {
   3.7005791165936737`*^9, 3.700579124822426*^9}, {3.700579299808877*^9, 
   3.7005793436956573`*^9}, {3.70057937935752*^9, 3.700579415453438*^9}, 
   3.7005794880111384`*^9, {3.700579525922323*^9, 3.700579537438947*^9}, {
   3.700579609197071*^9, 3.7005796126547546`*^9}, {3.7005796906490836`*^9, 
   3.700579775351965*^9}, {3.7005798101942415`*^9, 3.7005799407232313`*^9}, {
   3.700579971132533*^9, 3.700579974456066*^9}, {3.7005800176012807`*^9, 
   3.7005803845034084`*^9}, 3.700580563755313*^9, {3.700580604491683*^9, 
   3.7005806624478188`*^9}},
 CellLabel->
  "In[165]:=",ExpressionUUID->"64c1a148-0bdb-4610-854d-c9be9c03a832"]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "Subsection",
 CellChangeTimes->{{3.6999593332907157`*^9, 3.699959341978237*^9}, {
   3.6999616093131404`*^9, 3.6999616107935658`*^9}, 
   3.700577587368636*^9},ExpressionUUID->"fd137aa9-02f4-419b-a4a6-\
0d69d7f43a03"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6999616142207174`*^9, 3.6999616177256303`*^9}, 
   3.700577583451455*^9},
 CellLabel->
  "In[166]:=",ExpressionUUID->"ef6eb752-a7c6-4e9d-8392-3d1e27254bef"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Zeilberger Bijection", "Subsection",
 CellChangeTimes->{{3.7003946099547763`*^9, 
  3.700394615833289*^9}},ExpressionUUID->"fce2ca31-6f8d-4079-b8b3-\
669f5b424ff1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"phi1x", "[", 
    RowBox[{"{", 
     RowBox[{"x1_", ",", "y1_"}], "}"}], "]"}], ":=", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", "=", "x1"}], ";", 
       RowBox[{"y", "=", "y1"}], ";", 
       RowBox[{"x0", "=", "x"}], ";", 
       RowBox[{"i", "=", 
        RowBox[{"First", "[", 
         RowBox[{"succ", "[", 
          RowBox[{"y", ",", "1"}], "]"}], "]"}]}], ";", 
       RowBox[{"j", "=", "1"}], ";", 
       RowBox[{"i0", "=", "i"}], ";", 
       RowBox[{"j0", "=", "j"}], ";", 
       RowBox[{"t", "=", "0"}], ";", 
       RowBox[{"s", "=", "1"}]}], ")"}], ",", 
     RowBox[{"t", "\[NotEqual]", "1"}], ",", 
     RowBox[{"s", "++"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OddQ", "[", "s", "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"IsRed", "[", 
          RowBox[{"y", ",", "j"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"IsBlack", "[", 
            RowBox[{"y", ",", "i"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"EdgeList", "[", "x", "]"}], ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"First", "[", 
                  RowBox[{"succ", "[", 
                   RowBox[{"y", ",", "i"}], "]"}], "]"}]}], "]"}]}], "]"}], 
             ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2ydouble", "[", 
                RowBox[{"x", ",", "y", ",", "i"}], "]"}], ";", 
               RowBox[{"double", "=", 
                RowBox[{"double", "+", "1"}]}], ";", 
               RowBox[{"i0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"succ", "[", 
                  RowBox[{"y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j0", "=", "i"}], ";", 
               RowBox[{"x0", "=", "x"}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x0", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"s", "=", 
                RowBox[{"s", "+", "1"}]}], ";", 
               RowBox[{"Print", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y2x", "[", 
                RowBox[{"x", ",", "y", ",", "i"}], "]"}], ";", 
               RowBox[{"i0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"succ", "[", 
                  RowBox[{"y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j0", "=", "i"}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"Print", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], 
            "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "}"}], 
               ",", 
               RowBox[{"{", "}"}]}], "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t", "=", "1"}], ";", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}]}], ")"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"EdgeList", "[", "x", "]"}], ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}]}],
                 "]"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], ";", 
                 RowBox[{"double", "=", 
                  RowBox[{"double", "+", "1"}]}], ";", 
                 RowBox[{"i0", "=", "i"}], ";", 
                 RowBox[{"j0", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                   "]"}]}], ";", 
                 RowBox[{"x0", "=", "x"}], ";", 
                 RowBox[{"x", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"x2ydouble", "[", 
                    RowBox[{"x", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
                 RowBox[{"y", "=", 
                  RowBox[{"Last", "[", 
                   RowBox[{"x2ydouble", "[", 
                    RowBox[{"x0", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
                 RowBox[{"j", "=", "j0"}], ";", 
                 RowBox[{"i", "=", "i0"}], ";", 
                 RowBox[{"s", "=", 
                  RowBox[{"s", "+", "1"}]}], ";", 
                 RowBox[{"Print", "[", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
                 RowBox[{"list", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], ";", 
                 RowBox[{"i0", "=", "i"}], ";", 
                 RowBox[{"j0", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                   "]"}]}], ";", 
                 RowBox[{"x", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"y2x", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
                 RowBox[{"y", "=", 
                  RowBox[{"Last", "[", 
                   RowBox[{"y2x", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
                 RowBox[{"j", "=", "j0"}], ";", 
                 RowBox[{"i", "=", "i0"}], ";", 
                 RowBox[{"Print", "[", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
                 RowBox[{"list", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], 
              "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Intersection", "[", 
               RowBox[{
                RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                RowBox[{"EdgeList", "[", 
                 RowBox[{"y", ",", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"t", "=", "1"}], ";", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}]}], ")"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"EdgeList", "[", "x", "]"}], ",", 
               RowBox[{"BetterFirst", "[", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                  RowBox[{"EdgeList", "[", 
                   RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}]}],
               "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2ydouble", "[", 
                RowBox[{"x", ",", "y", ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                  "]"}]}], "]"}], ";", 
               RowBox[{"double", "=", 
                RowBox[{"double", "+", "1"}]}], ";", 
               RowBox[{"i0", "=", "j"}], ";", 
               RowBox[{"j0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"VertexList", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                 "]"}]}], ";", 
               RowBox[{"x0", "=", "x"}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x0", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"s", "=", 
                RowBox[{"s", "+", "1"}]}], ";", 
               RowBox[{"Print", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y2x", "[", 
                RowBox[{"x", ",", "y", ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                  "]"}]}], "]"}], ";", 
               RowBox[{"i0", "=", "j"}], ";", 
               RowBox[{"j0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"VertexList", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                 "]"}]}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"Print", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], 
            "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"EdgeList", "[", 
               RowBox[{"x", ",", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
              RowBox[{"DirectedEdge", "[", 
               RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "}"}], ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"t", "=", "1"}], ";", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x2yEdge", "[", 
            RowBox[{"x", ",", "y", ",", 
             RowBox[{"DirectedEdge", "[", 
              RowBox[{"j", ",", 
               RowBox[{"Last", "[", 
                RowBox[{"VertexList", "[", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
              "]"}]}], "]"}], ";", 
           RowBox[{"i0", "=", 
            RowBox[{"Last", "[", 
             RowBox[{"VertexList", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"EdgeList", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], ";", 
           RowBox[{"j0", "=", "j"}], ";", 
           RowBox[{"y", "=", 
            RowBox[{"Last", "[", 
             RowBox[{"x2yEdge", "[", 
              RowBox[{"x", ",", "y", ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"j", ",", 
                 RowBox[{"Last", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"x", "=", 
            RowBox[{"BetterFirst", "[", 
             RowBox[{"x2yEdge", "[", 
              RowBox[{"x", ",", "y", ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"j", ",", 
                 RowBox[{"Last", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"i", "=", "i0"}], ";", 
           RowBox[{"Print", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
           RowBox[{"list", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"list", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], "]"}]}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phi1y", "[", 
    RowBox[{"{", 
     RowBox[{"x1_", ",", "y1_"}], "}"}], "]"}], ":=", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", "=", "x1"}], ";", 
       RowBox[{"y", "=", "y1"}], ";", 
       RowBox[{"x0", "=", "x"}], ";", 
       RowBox[{"i", "=", 
        RowBox[{"First", "[", 
         RowBox[{"succ", "[", 
          RowBox[{"x", ",", "1"}], "]"}], "]"}]}], ";", 
       RowBox[{"j", "=", "1"}], ";", 
       RowBox[{"i0", "=", "i"}], ";", 
       RowBox[{"j0", "=", "j"}], ";", 
       RowBox[{"t", "=", "0"}], ";", 
       RowBox[{"s", "=", "1"}]}], ")"}], ",", 
     RowBox[{"t", "\[NotEqual]", "1"}], ",", 
     RowBox[{"s", "++"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OddQ", "[", "s", "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"IsRed", "[", 
          RowBox[{"x", ",", "j"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"IsBlack", "[", 
            RowBox[{"x", ",", "i"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"EdgeList", "[", "y", "]"}], ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"First", "[", 
                  RowBox[{"succ", "[", 
                   RowBox[{"x", ",", "i"}], "]"}], "]"}]}], "]"}]}], "]"}], 
             ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2ydouble", "[", 
                RowBox[{"x", ",", "y", ",", "i"}], "]"}], ";", 
               RowBox[{"double", "=", 
                RowBox[{"double", "+", "1"}]}], ";", 
               RowBox[{"i0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"succ", "[", 
                  RowBox[{"x", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j0", "=", "i"}], ";", 
               RowBox[{"x0", "=", "x"}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x0", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"s", "=", 
                RowBox[{"s", "+", "1"}]}], ";", 
               RowBox[{"Print", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2y", "[", 
                RowBox[{"x", ",", "y", ",", "i"}], "]"}], ";", 
               RowBox[{"i0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"succ", "[", 
                  RowBox[{"x", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j0", "=", "i"}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2y", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2y", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"Print", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], 
            "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "}"}], 
               ",", 
               RowBox[{"{", "}"}]}], "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t", "=", "1"}], ";", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}]}], ")"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"EdgeList", "[", "y", "]"}], ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}]}],
                 "]"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], ";", 
                 RowBox[{"double", "=", 
                  RowBox[{"double", "+", "1"}]}], ";", 
                 RowBox[{"i0", "=", "i"}], ";", 
                 RowBox[{"j0", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                   "]"}]}], ";", 
                 RowBox[{"x0", "=", "x"}], ";", 
                 RowBox[{"x", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"x2ydouble", "[", 
                    RowBox[{"x", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
                 RowBox[{"y", "=", 
                  RowBox[{"Last", "[", 
                   RowBox[{"x2ydouble", "[", 
                    RowBox[{"x0", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
                 RowBox[{"j", "=", "j0"}], ";", 
                 RowBox[{"i", "=", "i0"}], ";", 
                 RowBox[{"s", "=", 
                  RowBox[{"s", "+", "1"}]}], ";", 
                 RowBox[{"Print", "[", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
                 RowBox[{"list", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x2y", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], ";", 
                 RowBox[{"i0", "=", "i"}], ";", 
                 RowBox[{"j0", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                   "]"}]}], ";", 
                 RowBox[{"y", "=", 
                  RowBox[{"Last", "[", 
                   RowBox[{"x2y", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
                 RowBox[{"x", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"x2y", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
                 RowBox[{"j", "=", "j0"}], ";", 
                 RowBox[{"i", "=", "i0"}], ";", 
                 RowBox[{"Print", "[", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
                 RowBox[{"list", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], 
              "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Intersection", "[", 
               RowBox[{
                RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                RowBox[{"EdgeList", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"t", "=", "1"}], ";", 
             RowBox[{"{", 
              RowBox[{"x", ",", "y"}], "}"}]}], ")"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"EdgeList", "[", "y", "]"}], ",", 
               RowBox[{"BetterFirst", "[", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                  RowBox[{"EdgeList", "[", 
                   RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}]}],
               "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2ydouble", "[", 
                RowBox[{"x", ",", "y", ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                  "]"}]}], "]"}], ";", 
               RowBox[{"double", "=", 
                RowBox[{"double", "+", "1"}]}], ";", 
               RowBox[{"i0", "=", "j"}], ";", 
               RowBox[{"j0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"VertexList", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                 "]"}]}], ";", 
               RowBox[{"x0", "=", "x"}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x0", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"s", "=", 
                RowBox[{"s", "+", "1"}]}], ";", 
               RowBox[{"Print", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2y", "[", 
                RowBox[{"x", ",", "y", ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                  "]"}]}], "]"}], ";", 
               RowBox[{"i0", "=", "j"}], ";", 
               RowBox[{"j0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"VertexList", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                 "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2y", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2y", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "x", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"Print", "[", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], 
            "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"EdgeList", "[", 
               RowBox[{"y", ",", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
              RowBox[{"DirectedEdge", "[", 
               RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "}"}], ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"t", "=", "1"}], ";", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"y2xEdge", "[", 
            RowBox[{"x", ",", "y", ",", 
             RowBox[{"DirectedEdge", "[", 
              RowBox[{"j", ",", 
               RowBox[{"Last", "[", 
                RowBox[{"VertexList", "[", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
              "]"}]}], "]"}], ";", 
           RowBox[{"i0", "=", 
            RowBox[{"Last", "[", 
             RowBox[{"VertexList", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"EdgeList", "[", 
                 RowBox[{"y", ",", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], ";", 
           RowBox[{"j0", "=", "j"}], ";", 
           RowBox[{"x", "=", 
            RowBox[{"BetterFirst", "[", 
             RowBox[{"y2xEdge", "[", 
              RowBox[{"x", ",", "y", ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"j", ",", 
                 RowBox[{"Last", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"y", "=", 
            RowBox[{"Last", "[", 
             RowBox[{"y2xEdge", "[", 
              RowBox[{"x", ",", "y", ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"j", ",", 
                 RowBox[{"Last", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"i", "=", "i0"}], ";", 
           RowBox[{"Print", "[", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], "]"}], ";", 
           RowBox[{"list", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"list", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], ")"}]}], "]"}]}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phi1", "[", 
   RowBox[{"{", 
    RowBox[{"f1_", ",", "f2_"}], "}"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"MemberQ", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"succ", "[", 
        RowBox[{"f1", ",", "1"}], "]"}], "}"}], ",", 
      RowBox[{"{", "}"}]}], "]"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"IsRed", "[", 
       RowBox[{"f2", ",", "1"}], "]"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"y2x", "[", 
          RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}], ";", 
        RowBox[{"list", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"list", ",", 
           RowBox[{"y2x", "[", 
            RowBox[{"f1", ",", "f2", ",", "1"}], "]"}]}], "]"}]}], ";", 
        RowBox[{"phi1y", "[", 
         RowBox[{"y2x", "[", 
          RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}], ";", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"y2x", "[", 
          RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}], ";", 
        RowBox[{"list", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"list", ",", 
           RowBox[{"y2x", "[", 
            RowBox[{"f1", ",", "f2", ",", "1"}], "]"}]}], "]"}]}], ";", 
        RowBox[{"Return", "[", 
         RowBox[{"y2x", "[", 
          RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}]}], ")"}]}], "]"}],
     ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"IsRed", "[", 
       RowBox[{"f1", ",", "1"}], "]"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"x2y", "[", 
          RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}], ";", 
        RowBox[{"list", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"list", ",", 
           RowBox[{"x2y", "[", 
            RowBox[{"f1", ",", "f2", ",", "1"}], "]"}]}], "]"}]}], ";", 
        RowBox[{"phi1x", "[", 
         RowBox[{"x2y", "[", 
          RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}], ";", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"x2y", "[", 
          RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}], ";", 
        RowBox[{"list", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"list", ",", 
           RowBox[{"x2y", "[", 
            RowBox[{"f1", ",", "f2", ",", "1"}], "]"}]}], "]"}]}], ";", 
        RowBox[{"Return", "[", 
         RowBox[{"x2y", "[", 
          RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}]}], ")"}]}], 
     "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7003954659875636`*^9, 3.7003954665501375`*^9}, {
   3.7004021616227875`*^9, 3.70040216205937*^9}, 3.700403366729416*^9, {
   3.7004062905912075`*^9, 3.700406291682534*^9}, 3.7004069193792353`*^9, {
   3.70055882599035*^9, 3.7005588405131893`*^9}, {3.7008292864409356`*^9, 
   3.7008293344790497`*^9}, 3.700912861588565*^9, 3.701012932932724*^9, 
   3.701164618053122*^9, 3.7027500309602413`*^9},
 CellLabel->
  "In[167]:=",ExpressionUUID->"a9c8f8ac-0ccb-40e0-92e4-4e4aa3c48b64"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Final Algorithm", "Subsection",
 CellChangeTimes->{{3.700405175833031*^9, 
  3.7004051783746963`*^9}},ExpressionUUID->"97753d0f-34ed-4715-a154-\
b365b5fe2bc1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RHP", "[", 
   RowBox[{"xfinal_", ",", "yfinal_"}], "]"}], ":=", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"xtrans", "=", "xfinal"}], ";", 
     RowBox[{"ytrans", "=", "yfinal"}], ";", 
     RowBox[{"double", "=", "0"}], ";", 
     RowBox[{"z", "=", "0"}], ";", 
     RowBox[{"in", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"in2", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"list", "=", 
      RowBox[{"{", "}"}]}]}], ",", 
    RowBox[{"!", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Proper", "[", 
        RowBox[{"xtrans", ",", "ytrans"}], "]"}], "&&", 
       RowBox[{"z", ">", "0"}]}], ")"}]}], ",", 
    RowBox[{"z", "++"}], ",", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"list", ",", 
        RowBox[{"{", 
         RowBox[{"xtrans", ",", "ytrans"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{"xtrans", ",", "ytrans"}], "}"}], "]"}], ";", 
     RowBox[{"in2", "=", 
      RowBox[{"phi1", "[", 
       RowBox[{"{", 
        RowBox[{"xtrans", ",", "ytrans"}], "}"}], "]"}]}], ";", 
     RowBox[{"in", "=", 
      RowBox[{"phi2", "[", "in2", "]"}]}], ";", 
     RowBox[{"xtrans", "=", 
      RowBox[{"BetterFirst", "[", "in", "]"}]}], ";", 
     RowBox[{"ytrans", "=", 
      RowBox[{"Last", "[", "in", "]"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.700407076071804*^9, 3.700407076594051*^9}, 
   3.700407472823694*^9, {3.7005804134960136`*^9, 3.700580416309373*^9}, 
   3.700829275794774*^9, 3.7009128787917624`*^9, 3.702750051153655*^9},
 CellLabel->
  "In[170]:=",ExpressionUUID->"1889f6c6-62a7-45fe-a93d-ecef88ea6fef"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
No Print Version - genphi1x starts with an edge moved into y (namely the \
graph with something moving backwards). If we start with s1, then we move one \
edge into y and then start genphi1x. If we start with s2, then we move an \
edge backward from y to x and another edge forward from x to y before \
starting on genphi1x.\
\>", "Subsection",
 CellChangeTimes->{
  3.7009134597128096`*^9, {3.749808860924261*^9, 3.749808942916997*^9}, {
   3.749809966152115*^9, 
   3.7498100424641466`*^9}},ExpressionUUID->"69c048ae-5a3f-448b-9140-\
763ce72b2ab3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"genphi1xnp", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "f2__"}], "}"}], ",", "y1_", ",", "bk_", ",", 
     "start_"}], "]"}], ":=", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x", "=", "x1"}], ";", 
       RowBox[{"y", "=", "y1"}], ";", 
       RowBox[{"newf2", "=", "f2"}], ";", 
       RowBox[{"x0", "=", "x"}], ";", 
       RowBox[{"i", "=", 
        RowBox[{"First", "[", 
         RowBox[{"succ", "[", 
          RowBox[{"y", ",", "start"}], "]"}], "]"}]}], ";", 
       RowBox[{"j", "=", "start"}], ";", 
       RowBox[{"i0", "=", "i"}], ";", 
       RowBox[{"j0", "=", "j"}], ";", 
       RowBox[{"t", "=", "0"}], ";", 
       RowBox[{"s", "=", "1"}]}], ")"}], ",", 
     RowBox[{"t", "\[NotEqual]", "1"}], ",", 
     RowBox[{"s", "++"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OddQ", "[", "s", "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"IsRed", "[", 
          RowBox[{"y", ",", "j"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"IsBlack", "[", 
            RowBox[{"y", ",", "i"}], "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"EdgeList", "[", "x", "]"}], ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"i", ",", 
                 RowBox[{"First", "[", 
                  RowBox[{"succ", "[", 
                   RowBox[{"y", ",", "i"}], "]"}], "]"}]}], "]"}]}], "]"}], 
             ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2ydouble", "[", 
                RowBox[{"x", ",", "y", ",", "i"}], "]"}], ";", 
               RowBox[{"i0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"succ", "[", 
                  RowBox[{"y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j0", "=", "i"}], ";", 
               RowBox[{"x0", "=", "x"}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x0", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"s", "=", 
                RowBox[{"s", "+", "1"}]}], ";", 
               RowBox[{
                RowBox[{"newf2", "[", 
                 RowBox[{"[", "bk", "]"}], "]"}], "=", "y"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "newf2"}], "}"}]}], "]"}]}]}], ")"}], 
             ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y2x", "[", 
                RowBox[{"x", ",", "y", ",", "i"}], "]"}], ";", 
               RowBox[{"i0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"succ", "[", 
                  RowBox[{"y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j0", "=", "i"}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", "i"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{
                RowBox[{"newf2", "[", 
                 RowBox[{"[", "bk", "]"}], "]"}], "=", "y"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "newf2"}], "}"}]}], "]"}]}]}], ")"}]}], 
            "]"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "}"}], 
               ",", 
               RowBox[{"{", "}"}]}], "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"t", "=", "1"}], ";", 
               RowBox[{"{", 
                RowBox[{"x", ",", "newf2"}], "}"}]}], ")"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{"EdgeList", "[", "x", "]"}], ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}]}],
                 "]"}], ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], ";", 
                 RowBox[{"i0", "=", "i"}], ";", 
                 RowBox[{"j0", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                   "]"}]}], ";", 
                 RowBox[{"x0", "=", "x"}], ";", 
                 RowBox[{"x", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"x2ydouble", "[", 
                    RowBox[{"x", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
                 RowBox[{"y", "=", 
                  RowBox[{"Last", "[", 
                   RowBox[{"x2ydouble", "[", 
                    RowBox[{"x0", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
                 RowBox[{"j", "=", "j0"}], ";", 
                 RowBox[{"i", "=", "i0"}], ";", 
                 RowBox[{"s", "=", 
                  RowBox[{"s", "+", "1"}]}], ";", 
                 RowBox[{
                  RowBox[{"newf2", "[", 
                   RowBox[{"[", "bk", "]"}], "]"}], "=", "y"}], ";", 
                 RowBox[{"list", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "newf2"}], "}"}]}], "]"}]}]}], ")"}], 
               ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], ";", 
                 RowBox[{"i0", "=", "i"}], ";", 
                 RowBox[{"j0", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                   "]"}]}], ";", 
                 RowBox[{"x", "=", 
                  RowBox[{"BetterFirst", "[", 
                   RowBox[{"y2x", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
                 RowBox[{"y", "=", 
                  RowBox[{"Last", "[", 
                   RowBox[{"y2x", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
                 RowBox[{"j", "=", "j0"}], ";", 
                 RowBox[{"i", "=", "i0"}], ";", 
                 RowBox[{
                  RowBox[{"newf2", "[", 
                   RowBox[{"[", "bk", "]"}], "]"}], "=", "y"}], ";", 
                 RowBox[{"list", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"list", ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "newf2"}], "}"}]}], "]"}]}]}], ")"}]}], 
              "]"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Intersection", "[", 
               RowBox[{
                RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                RowBox[{"EdgeList", "[", 
                 RowBox[{"y", ",", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "}"}], 
             ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"t", "=", "1"}], ";", 
             RowBox[{"{", 
              RowBox[{"x", ",", "newf2"}], "}"}]}], ")"}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"EdgeList", "[", "x", "]"}], ",", 
               RowBox[{"BetterFirst", "[", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                  RowBox[{"EdgeList", "[", 
                   RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}]}],
               "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x2ydouble", "[", 
                RowBox[{"x", ",", "y", ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                  "]"}]}], "]"}], ";", 
               RowBox[{"double", "=", 
                RowBox[{"double", "+", "1"}]}], ";", 
               RowBox[{"i0", "=", "j"}], ";", 
               RowBox[{"j0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"VertexList", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                 "]"}]}], ";", 
               RowBox[{"x0", "=", "x"}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"x2ydouble", "[", 
                  RowBox[{"x0", ",", "y", ",", "j0"}], "]"}], "]"}]}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"s", "=", 
                RowBox[{"s", "+", "1"}]}], ";", 
               RowBox[{
                RowBox[{"newf2", "[", 
                 RowBox[{"[", "bk", "]"}], "]"}], "=", "y"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "newf2"}], "}"}]}], "]"}]}]}], ")"}], 
             ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"y2x", "[", 
                RowBox[{"x", ",", "y", ",", 
                 RowBox[{"BetterFirst", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                  "]"}]}], "]"}], ";", 
               RowBox[{"i0", "=", "j"}], ";", 
               RowBox[{"j0", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"VertexList", "[", 
                  RowBox[{"Intersection", "[", 
                   RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                 "]"}]}], ";", 
               RowBox[{"x", "=", 
                RowBox[{"BetterFirst", "[", 
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
               RowBox[{"y", "=", 
                RowBox[{"Last", "[", 
                 RowBox[{"y2x", "[", 
                  RowBox[{"x", ",", "y", ",", 
                   RowBox[{"BetterFirst", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"Intersection", "[", 
                    RowBox[{
                    RowBox[{"RedEdges", "[", "y", "]"}], ",", 
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"y", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"_", ",", "j"}], "]"}]}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ";", 
               RowBox[{"i", "=", "i0"}], ";", 
               RowBox[{"j", "=", "j0"}], ";", 
               RowBox[{
                RowBox[{"newf2", "[", 
                 RowBox[{"[", "bk", "]"}], "]"}], "=", "y"}], ";", 
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "newf2"}], "}"}]}], "]"}]}]}], ")"}]}], 
            "]"}]}], "]"}]}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{
              RowBox[{"EdgeList", "[", 
               RowBox[{"x", ",", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
              RowBox[{"DirectedEdge", "[", 
               RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "}"}], ",", 
           RowBox[{"{", "}"}]}], "]"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"t", "=", "1"}], ";", 
           RowBox[{"{", 
            RowBox[{"x", ",", "newf2"}], "}"}]}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"x2yEdge", "[", 
            RowBox[{"x", ",", "y", ",", 
             RowBox[{"DirectedEdge", "[", 
              RowBox[{"j", ",", 
               RowBox[{"Last", "[", 
                RowBox[{"VertexList", "[", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                   RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
              "]"}]}], "]"}], ";", 
           RowBox[{"i0", "=", 
            RowBox[{"Last", "[", 
             RowBox[{"VertexList", "[", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"EdgeList", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                RowBox[{"DirectedEdge", "[", 
                 RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], ";", 
           RowBox[{"j0", "=", "j"}], ";", 
           RowBox[{"y", "=", 
            RowBox[{"Last", "[", 
             RowBox[{"x2yEdge", "[", 
              RowBox[{"x", ",", "y", ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"j", ",", 
                 RowBox[{"Last", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"x", "=", 
            RowBox[{"BetterFirst", "[", 
             RowBox[{"x2yEdge", "[", 
              RowBox[{"x", ",", "y", ",", 
               RowBox[{"DirectedEdge", "[", 
                RowBox[{"j", ",", 
                 RowBox[{"Last", "[", 
                  RowBox[{"VertexList", "[", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "_"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"j", ",", "i"}], "]"}]}], "]"}], "]"}], "]"}]}], 
                "]"}]}], "]"}], "]"}]}], ";", 
           RowBox[{"i", "=", "i0"}], ";", 
           RowBox[{
            RowBox[{"newf2", "[", 
             RowBox[{"[", "bk", "]"}], "]"}], "=", "y"}], ";", 
           RowBox[{"list", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"list", ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", "newf2"}], "}"}]}], "]"}]}]}], ")"}]}], 
        "]"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"phi1np", "[", 
    RowBox[{"{", 
     RowBox[{"f1_", ",", "f2_"}], "}"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"succ", "[", 
         RowBox[{"f1", ",", "1"}], "]"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"IsRed", "[", 
        RowBox[{"f2", ",", "1"}], "]"}], ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"list", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"list", ",", 
            RowBox[{"y2x", "[", 
             RowBox[{"f1", ",", "f2", ",", "1"}], "]"}]}], "]"}]}], ";", 
         RowBox[{"phi1ynp", "[", 
          RowBox[{"y2x", "[", 
           RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}], ";", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}], ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"list", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"list", ",", 
            RowBox[{"y2x", "[", 
             RowBox[{"f1", ",", "f2", ",", "1"}], "]"}]}], "]"}]}], ";", 
         RowBox[{"Return", "[", 
          RowBox[{"y2x", "[", 
           RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}]}], ")"}]}], 
      "]"}], ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"IsRed", "[", 
        RowBox[{"f1", ",", "1"}], "]"}], ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"list", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"list", ",", 
            RowBox[{"x2y", "[", 
             RowBox[{"f1", ",", "f2", ",", "1"}], "]"}]}], "]"}]}], ";", 
         RowBox[{"phi1xnp", "[", 
          RowBox[{"x2y", "[", 
           RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}], ";", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], "]"}]}], ")"}], ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"list", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"list", ",", 
            RowBox[{"x2y", "[", 
             RowBox[{"f1", ",", "f2", ",", "1"}], "]"}]}], "]"}]}], ";", 
         RowBox[{"Return", "[", 
          RowBox[{"x2y", "[", 
           RowBox[{"f1", ",", "f2", ",", "1"}], "]"}], "]"}]}], ")"}]}], 
      "]"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genphi1np", "[", 
    RowBox[{"{", 
     RowBox[{"f1_", ",", "f2__"}], "}"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"k1", "=", 
      RowBox[{
       RowBox[{"Length", "[", "f2", "]"}], "+", "1"}]}], ";", 
     RowBox[{"x", "=", "f1"}], ";", 
     RowBox[{"newf2", "=", "f2"}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"S1", "[", 
        RowBox[{"f1", ",", "f2"}], "]"}], ",", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"bk", "=", "1"}], ",", 
         RowBox[{"bk", "<", 
          RowBox[{
           RowBox[{"Length", "[", "f2", "]"}], "+", "1"}]}], ",", 
         RowBox[{"bk", "++"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"IsRed", "[", 
            RowBox[{"x", ",", "bk"}], "]"}], ",", 
           RowBox[{
            RowBox[{"list", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"list", ",", 
               RowBox[{"x2yk", "[", 
                RowBox[{"x", ",", 
                 RowBox[{"newf2", "[", 
                  RowBox[{"[", "bk", "]"}], "]"}], ",", "bk", ",", "bk", ",", 
                 "newf2"}], "]"}]}], "]"}]}], ";", 
            RowBox[{"genphi1xnp", "[", 
             RowBox[{
              RowBox[{"x2yk", "[", 
               RowBox[{"x", ",", 
                RowBox[{"newf2", "[", 
                 RowBox[{"[", "bk", "]"}], "]"}], ",", "bk", ",", "bk", ",", 
                "newf2"}], "]"}], ",", "y0", ",", "bk", ",", "bk"}], "]"}]}], 
           ",", 
           RowBox[{"list", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"list", ",", 
              RowBox[{"x2yk", "[", 
               RowBox[{"x", ",", 
                RowBox[{"newf2", "[", 
                 RowBox[{"[", "bk", "]"}], "]"}], ",", "bk", ",", "bk", ",", 
                "newf2"}], "]"}]}], "]"}]}]}], "]"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "<", "k1"}], ",", 
          RowBox[{"k", "++"}], ",", 
          RowBox[{
           RowBox[{"ultroot", "=", 
            RowBox[{"Rootoftheta", "[", 
             RowBox[{
              RowBox[{"newf2", "[", 
               RowBox[{"[", 
                RowBox[{"k1", "-", "k"}], "]"}], "]"}], ",", 
              RowBox[{"k1", "-", "k"}], ",", "k1"}], "]"}]}], ";", 
           RowBox[{"start", "=", 
            RowBox[{"BetterFirst", "[", 
             RowBox[{"VertexList", "[", 
              RowBox[{"Intersection", "[", 
               RowBox[{
                RowBox[{"RedEdges", "[", 
                 RowBox[{"newf2", "[", 
                  RowBox[{"[", 
                   RowBox[{"k1", "-", "k"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"EdgeList", "[", 
                 RowBox[{
                  RowBox[{"newf2", "[", 
                   RowBox[{"[", 
                    RowBox[{"k1", "-", "k"}], "]"}], "]"}], ",", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{"_", ",", "ultroot"}], "]"}]}], "]"}]}], "]"}], 
              "]"}], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"IsRed", "[", 
              RowBox[{
               RowBox[{"newf2", "[", 
                RowBox[{"[", 
                 RowBox[{"k1", "-", "k"}], "]"}], "]"}], ",", 
               RowBox[{"k1", "-", "k"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"EdgeList", "[", "x", "]"}], ",", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{"start", ",", "ultroot"}], "]"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{"list", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"list", ",", 
                    RowBox[{"x2ydoublek", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"newf2", "[", 
                    RowBox[{"[", 
                    RowBox[{"k1", "-", "k"}], "]"}], "]"}], ",", "start", ",", 
                    RowBox[{"k1", "-", "k"}], ",", "newf2"}], "]"}]}], 
                   "]"}]}], ";", 
                 RowBox[{"genphi1xnp", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"x", ",", "newf2"}], "}"}], ",", "y0", ",", 
                   RowBox[{"k1", "-", "k"}], ",", "start"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"list", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{"list", ",", 
                    RowBox[{"y2xk", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"newf2", "[", 
                    RowBox[{"[", 
                    RowBox[{"k1", "-", "k"}], "]"}], "]"}], ",", "start", ",", 
                    RowBox[{"k1", "-", "k"}], ",", "newf2"}], "]"}]}], 
                   "]"}]}], ";", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"VertexList", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"start", ",", "_"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"start", ",", "ultroot"}], "]"}]}], "]"}], "]"}], 
                    "\[NotEqual]", 
                    RowBox[{"{", "}"}]}], ",", 
                   RowBox[{
                    RowBox[{"list", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"list", ",", 
                    RowBox[{"x2ykEdge", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"newf2", "[", 
                    RowBox[{"[", 
                    RowBox[{"k1", "-", "k"}], "]"}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"start", ",", 
                    RowBox[{"Last", "[", 
                    RowBox[{"VertexList", "[", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"EdgeList", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"start", ",", "_"}], "]"}]}], "]"}], ",", 
                    RowBox[{"DirectedEdge", "[", 
                    RowBox[{"start", ",", "ultroot"}], "]"}]}], "]"}], "]"}], 
                    "]"}]}], "]"}], ",", 
                    RowBox[{"k1", "-", "k"}], ",", "newf2"}], "]"}]}], 
                    "]"}]}], ";", 
                    RowBox[{"genphi1xnp", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x", ",", "newf2"}], "}"}], ",", "y0", ",", 
                    RowBox[{"k1", "-", "k"}], ",", "start"}], "]"}]}], ",", 
                   RowBox[{"k", "=", "k"}]}], "]"}]}]}], "]"}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"EdgeList", "[", 
                   RowBox[{"newf2", "[", 
                    RowBox[{"[", 
                    RowBox[{"k1", "-", "k"}], "]"}], "]"}], "]"}], ",", 
                  RowBox[{"DirectedEdge", "[", 
                   RowBox[{
                    RowBox[{"k1", "-", "k"}], ",", "_"}], "]"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{"bk", "=", 
                  RowBox[{"k1", "-", "k", "+", "1"}]}], ";", 
                 RowBox[{"k", "=", 
                  RowBox[{"k1", "+", "5"}]}]}], ",", 
                RowBox[{"k", "=", "k"}]}], "]"}]}], ",", 
             RowBox[{"list", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"list", ",", 
                RowBox[{"y2xk", "[", 
                 RowBox[{"x", ",", 
                  RowBox[{"newf2", "[", 
                   RowBox[{"[", 
                    RowBox[{"k1", "-", "k"}], "]"}], "]"}], ",", 
                  RowBox[{"k1", "-", "k"}], ",", 
                  RowBox[{"k1", "-", "k"}], ",", "newf2"}], "]"}]}], 
               "]"}]}]}], "]"}]}]}], "]"}], ";", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", ">", 
           RowBox[{"k1", "+", "3"}]}], ",", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"bk", "=", "bk"}], ",", 
            RowBox[{"bk", "<", "k1"}], ",", 
            RowBox[{"bk", "++"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"IsRed", "[", 
               RowBox[{"x", ",", "bk"}], "]"}], ",", 
              RowBox[{
               RowBox[{"list", "=", 
                RowBox[{"Append", "[", 
                 RowBox[{"list", ",", 
                  RowBox[{"x2yk", "[", 
                   RowBox[{"x", ",", 
                    RowBox[{"newf2", "[", 
                    RowBox[{"[", "bk", "]"}], "]"}], ",", "bk", ",", "bk", 
                    ",", "newf2"}], "]"}]}], "]"}]}], ";", 
               RowBox[{"genphi1xnp", "[", 
                RowBox[{
                 RowBox[{"x2yk", "[", 
                  RowBox[{"x", ",", 
                   RowBox[{"newf2", "[", 
                    RowBox[{"[", "bk", "]"}], "]"}], ",", "bk", ",", "bk", 
                   ",", "newf2"}], "]"}], ",", "y0", ",", "bk", ",", "bk"}], 
                "]"}]}], ",", 
              RowBox[{"list", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"list", ",", 
                 RowBox[{"x2yk", "[", 
                  RowBox[{"x", ",", 
                   RowBox[{"newf2", "[", 
                    RowBox[{"[", "bk", "]"}], "]"}], ",", "bk", ",", "bk", 
                   ",", "newf2"}], "]"}]}], "]"}]}]}], "]"}]}], "]"}], ",", 
          RowBox[{"k", "=", "k"}]}], "]"}]}]}], "]"}], ";", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"x", ",", "newf2"}], "}"}], "]"}]}], ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"genRHPnp", "[", 
    RowBox[{"xfinal_", ",", "yfinal__"}], "]"}], ":=", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"xtrans", "=", "xfinal"}], ";", 
      RowBox[{"ytrans", "=", "yfinal"}], ";", 
      RowBox[{"double", "=", "0"}], ";", 
      RowBox[{"z", "=", "0"}], ";", 
      RowBox[{"in", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"in2", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"list", "=", 
       RowBox[{"{", "}"}]}]}], ",", 
     RowBox[{"!", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Appropriate", "[", 
         RowBox[{"xtrans", ",", "ytrans"}], "]"}], "&&", 
        RowBox[{"z", ">", "0"}]}], ")"}]}], ",", 
     RowBox[{"z", "++"}], ",", 
     RowBox[{
      RowBox[{"list", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"list", ",", 
         RowBox[{"{", 
          RowBox[{"xtrans", ",", "ytrans"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"in2", "=", 
       RowBox[{"genphi1np", "[", 
        RowBox[{"{", 
         RowBox[{"xtrans", ",", "ytrans"}], "}"}], "]"}]}], ";", 
      RowBox[{"in", "=", 
       RowBox[{"genphi2", "[", "in2", "]"}]}], ";", 
      RowBox[{"xtrans", "=", 
       RowBox[{"BetterFirst", "[", "in", "]"}]}], ";", 
      RowBox[{"ytrans", "=", 
       RowBox[{"Last", "[", "in", "]"}]}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RHPsteps", "[", 
    RowBox[{"xfinal_", ",", "yfinal_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"xtrans", "=", "xfinal"}], ";", 
        RowBox[{"ytrans", "=", "yfinal"}], ";", 
        RowBox[{"double", "=", "0"}], ";", 
        RowBox[{"z", "=", "0"}], ";", 
        RowBox[{"in", "=", 
         RowBox[{"{", "}"}]}], ";", 
        RowBox[{"in2", "=", 
         RowBox[{"{", "}"}]}], ";", 
        RowBox[{"list", "=", 
         RowBox[{"{", "}"}]}]}], ",", 
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Proper", "[", 
           RowBox[{"xtrans", ",", "ytrans"}], "]"}], "&&", 
          RowBox[{"z", ">", "0"}]}], ")"}]}], ",", 
       RowBox[{"z", "++"}], ",", 
       RowBox[{
        RowBox[{"list", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"list", ",", 
           RowBox[{"{", 
            RowBox[{"xtrans", ",", "ytrans"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"in2", "=", 
         RowBox[{"phi1np", "[", 
          RowBox[{"{", 
           RowBox[{"xtrans", ",", "ytrans"}], "}"}], "]"}]}], ";", 
        RowBox[{"in", "=", 
         RowBox[{"phi2", "[", "in2", "]"}]}], ";", 
        RowBox[{"xtrans", "=", 
         RowBox[{"BetterFirst", "[", "in", "]"}]}], ";", 
        RowBox[{"ytrans", "=", 
         RowBox[{"Last", "[", "in", "]"}]}]}]}], "]"}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"Length", "[", "list", "]"}], "-", "1", "+", "double"}], 
      "]"}]}], ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AverageSteps", "[", 
   RowBox[{"n_", ",", "trials_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"totsteps", "=", "0"}], ";", 
       RowBox[{"try", "=", "0"}]}], ",", 
      RowBox[{"try", "<", "trials"}], ",", 
      RowBox[{"try", "++"}], ",", 
      RowBox[{
       RowBox[{"RHPnp", "[", 
        RowBox[{
         RowBox[{"DandelionTree", "[", "n", "]"}], ",", 
         RowBox[{"Prufer3Forest", "[", "n", "]"}]}], "]"}], ";", 
       RowBox[{"totsteps", "=", 
        RowBox[{"totsteps", "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "list", "]"}], "-", "1", "+", "double"}], 
          ")"}]}]}]}]}], "]"}], ";", 
    RowBox[{"Print", "[", 
     RowBox[{"totsteps", "/", "trials"}], "]"}]}], ")"}]}]}], "Input",
 CellChangeTimes->{
  3.701012970105266*^9, 3.7011646457435603`*^9, 3.7027500890353265`*^9, {
   3.7028080008274326`*^9, 3.7028080018882785`*^9}, {3.749808834485484*^9, 
   3.7498088477302*^9}, {3.7498089759434648`*^9, 3.7498089766309776`*^9}, {
   3.7498097046350384`*^9, 3.7498097180022774`*^9}, {3.7498098280099063`*^9, 
   3.7498098322338343`*^9}, {3.749809951638715*^9, 3.749809957360824*^9}, {
   3.7498100535502768`*^9, 3.749810112719782*^9}, {3.749810672063585*^9, 
   3.749810688039935*^9}, {3.749810794286165*^9, 3.7498108484991055`*^9}, {
   3.7498108802463727`*^9, 3.7498108885042877`*^9}, {3.749810920799748*^9, 
   3.749811065072628*^9}, {3.749811177947975*^9, 3.7498112243891363`*^9}, {
   3.749813559282093*^9, 3.7498135692540607`*^9}, {3.7498136527087407`*^9, 
   3.7498138564420323`*^9}, {3.7498138910651507`*^9, 
   3.7498139534837627`*^9}, {3.7498146895822473`*^9, 
   3.7498147509443984`*^9}, {3.749814802571731*^9, 3.749814807711669*^9}, {
   3.749814841339716*^9, 3.749814868280799*^9}, {3.7498149437223873`*^9, 
   3.749814963862952*^9}, {3.7498153965723863`*^9, 3.7498154417122483`*^9}, {
   3.749815473430005*^9, 3.7498155554421515`*^9}, {3.7498156069119453`*^9, 
   3.7498156078651342`*^9}, {3.749815782936345*^9, 3.749815886565545*^9}, {
   3.749815983008185*^9, 3.7498159986264644`*^9}, {3.7498161948970547`*^9, 
   3.749816222367625*^9}, {3.7498162639843836`*^9, 3.749816275799334*^9}, {
   3.74981630770016*^9, 3.749816436741227*^9}, {3.7498165087446885`*^9, 
   3.7498165977724023`*^9}, {3.7498166355816145`*^9, 
   3.7498166551457663`*^9}, {3.7498166988636827`*^9, 3.749816700129316*^9}, {
   3.74981674209032*^9, 3.7498167484885306`*^9}, 3.7498168451641703`*^9, {
   3.7498168842438927`*^9, 3.749816893132272*^9}, {3.74981695802785*^9, 
   3.749817164642776*^9}, {3.7498211079424806`*^9, 3.7498211666381435`*^9}, {
   3.7498213437969313`*^9, 3.7498213526109304`*^9}, {3.7498214194031487`*^9, 
   3.749821447225933*^9}, {3.7498216012998705`*^9, 3.74982165111922*^9}, {
   3.7498216944872394`*^9, 3.7498218184886847`*^9}, {3.7498218782220955`*^9, 
   3.7498219242436686`*^9}, {3.7498225666009645`*^9, 3.749822572757349*^9}, {
   3.7499030396567745`*^9, 3.7499030399849033`*^9}, {3.749913042260048*^9, 
   3.7499131659396944`*^9}, {3.749913268432024*^9, 3.749913295713049*^9}, {
   3.749915051088566*^9, 3.7499151017400513`*^9}, {3.7499924019036307`*^9, 
   3.7499924125747614`*^9}, {3.749992607661892*^9, 3.7499926414895973`*^9}, {
   3.749992712214861*^9, 3.7499927204153433`*^9}, {3.7499966013596535`*^9, 
   3.7499966075167933`*^9}, {3.749996643880454*^9, 3.7499966451929445`*^9}, {
   3.7499966878876204`*^9, 3.749996706708777*^9}, {3.749997579160639*^9, 
   3.749997586996169*^9}, {3.749997655473998*^9, 3.7499976645379105`*^9}, {
   3.7499977526296062`*^9, 3.749997799048134*^9}, {3.749998649855832*^9, 
   3.749998709297549*^9}, {3.7499992670446177`*^9, 3.749999267825906*^9}, {
   3.749999806754908*^9, 3.749999846606798*^9}, {3.7501572801542215`*^9, 
   3.750157282219283*^9}, {3.750157366138506*^9, 3.7501573742066135`*^9}, {
   3.7501574111810484`*^9, 3.7501574542924986`*^9}, {3.750157542764903*^9, 
   3.7501575489327087`*^9}, 3.7501575836862307`*^9, {3.7501577684569488`*^9, 
   3.750157818915902*^9}, {3.7501578616185913`*^9, 3.7501578965132008`*^9}, {
   3.7501579400890713`*^9, 3.7501580087733717`*^9}, {3.75015868339756*^9, 
   3.7501587040522346`*^9}, {3.750158749575492*^9, 3.7501587535541935`*^9}, {
   3.7501698394644823`*^9, 3.750169848321645*^9}, {3.7501698830268383`*^9, 
   3.7501698863094997`*^9}, {3.7501699706849527`*^9, 3.750170091594485*^9}, {
   3.750170124939972*^9, 3.7501701585386367`*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"37850a6a-391c-4faf-85a3-1b9dec2b9e5e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1141.2, 574.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4fa29c96-06d5-4b66-8d5f-1a83cecdaac7"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 171, 3, 98, "Title",ExpressionUUID->"353f7f4e-b6c8-4fbe-a8a0-ffff6354133d"],
Cell[CellGroupData[{
Cell[776, 29, 173, 3, 67, "Section",ExpressionUUID->"19e9dab3-8b82-459c-af45-f22713da48ab"],
Cell[952, 34, 30159, 832, 2540, "Input",ExpressionUUID->"d051c5c1-0e12-4696-9b11-f9321b41fc84"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31148, 871, 210, 4, 67, "Section",ExpressionUUID->"bd6fc6f5-c27f-437d-bea9-f11378336a99"],
Cell[31361, 877, 451, 10, 69, "Subsection",ExpressionUUID->"b61127bf-d676-47a2-999e-7b0f3fe8f64b"],
Cell[CellGroupData[{
Cell[31837, 891, 343, 5, 38, "Subsection",ExpressionUUID->"854e78fe-61d4-4e3b-8439-0c067fb7f504"],
Cell[32183, 898, 2136, 53, 124, "Input",ExpressionUUID->"101b5d8b-905b-4a74-8c32-ff314c919072"],
Cell[34322, 953, 4232, 102, 181, "Input",ExpressionUUID->"27ee17b7-91d2-40b7-b3da-878eafead073"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38591, 1060, 163, 3, 54, "Subsection",ExpressionUUID->"1d47466a-920d-4d9a-83cb-cbbaefbe2401"],
Cell[38757, 1065, 1446, 41, 86, "Input",ExpressionUUID->"95edccaf-71c7-4646-ad49-276a4ba606c1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40240, 1111, 435, 6, 54, "Subsection",ExpressionUUID->"6d7c2447-7369-4730-80e8-c1b1c8237a58"],
Cell[40678, 1119, 4614, 127, 238, "Input",ExpressionUUID->"e535c2ad-c642-4251-a8a9-578bbf77532a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45329, 1251, 351, 5, 54, "Subsection",ExpressionUUID->"80c6e2c7-20e4-45b8-ab0d-db1dd2df2350"],
Cell[45683, 1258, 3307, 84, 143, "Input",ExpressionUUID->"f3ffe2bd-6a5f-4e41-bdc7-d832c5f117f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49027, 1347, 163, 3, 54, "Subsection",ExpressionUUID->"42dc2f6d-7ccc-4eb5-899e-d8a205575486"],
Cell[49193, 1352, 2633, 75, 162, "Input",ExpressionUUID->"27785a04-2068-4671-a26f-a47f7026571b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51863, 1432, 276, 4, 54, "Subsection",ExpressionUUID->"c1da5047-01ee-4fc9-9a36-79d034393ec4"],
Cell[52142, 1438, 769, 16, 28, "Input",ExpressionUUID->"16962fcb-b041-4e86-8d92-6e16698de399"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52948, 1459, 299, 7, 54, "Subsection",ExpressionUUID->"f1dab67f-ab5f-4f25-9ce6-044ca74ff1cf"],
Cell[53250, 1468, 3247, 84, 143, "Input",ExpressionUUID->"ba5bc063-27ee-4651-b6ad-400d9a9acf59"],
Cell[56500, 1554, 8168, 188, 276, "Input",ExpressionUUID->"762cd5e6-33d8-48d1-a9e1-b66afd69ed8b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64705, 1747, 246, 6, 54, "Subsection",ExpressionUUID->"e200c4ae-2785-4a39-a0f0-0aa548b404da"],
Cell[64954, 1755, 3243, 78, 105, "Input",ExpressionUUID->"61111c5f-374d-4f35-973a-f2059c51dbfe"],
Cell[68200, 1835, 2301, 65, 105, "Input",ExpressionUUID->"c5167f65-1043-447a-a90f-d7de03402334"],
Cell[70504, 1902, 2226, 64, 105, "Input",ExpressionUUID->"5b49ca4f-66dc-4506-bfd0-f8128f640fd1"],
Cell[72733, 1968, 2354, 65, 105, "Input",ExpressionUUID->"4e923679-9519-42ce-9b4f-982adcf03f3e"],
Cell[75090, 2035, 2307, 65, 105, "Input",ExpressionUUID->"2fcd7ddb-e293-41fa-8017-5d16397cd998"],
Cell[77400, 2102, 2841, 80, 200, "Input",ExpressionUUID->"b32c873c-1578-4b75-b3e9-1d0499d202f3"],
Cell[80244, 2184, 2855, 79, 181, "Input",ExpressionUUID->"7a81f303-4965-49da-84f8-700d0355441e"],
Cell[83102, 2265, 2834, 79, 200, "Input",ExpressionUUID->"39d40393-ed04-4876-92e7-d64c0413120d"],
Cell[85939, 2346, 3152, 84, 181, "Input",ExpressionUUID->"612cb631-eb26-4cfd-acd9-4604bf459c41"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89128, 2435, 175, 3, 54, "Subsection",ExpressionUUID->"7cd229d3-1da3-44be-83a6-6b646d299e81"],
Cell[89306, 2440, 153, 3, 28, "Input",ExpressionUUID->"937082bb-92c8-495a-89e7-c961fc23f599"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89496, 2448, 175, 3, 54, "Subsection",ExpressionUUID->"a00522ce-4a14-4c4c-b05b-f3c362c5ecce"],
Cell[89674, 2453, 175, 3, 28, "Input",ExpressionUUID->"2705aabd-572b-438d-ba8e-2336900ba470"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89886, 2461, 223, 4, 54, "Subsection",ExpressionUUID->"41ed6071-92f6-4dca-b3ca-239e3a8d802f"],
Cell[90112, 2467, 1033, 15, 28, "Input",ExpressionUUID->"64c1a148-0bdb-4610-854d-c9be9c03a832"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91182, 2487, 227, 4, 54, "Subsection",ExpressionUUID->"fd137aa9-02f4-419b-a4a6-0d69d7f43a03"],
Cell[91412, 2493, 205, 4, 28, "Input",ExpressionUUID->"ef6eb752-a7c6-4e9d-8392-3d1e27254bef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91654, 2502, 170, 3, 54, "Subsection",ExpressionUUID->"fce2ca31-6f8d-4079-b8b3-669f5b424ff1"],
Cell[91827, 2507, 49162, 1134, 3530, "Input",ExpressionUUID->"a9c8f8ac-0ccb-40e0-92e4-4e4aa3c48b64"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141026, 3646, 165, 3, 54, "Subsection",ExpressionUUID->"97753d0f-34ed-4715-a154-b365b5fe2bc1"],
Cell[141194, 3651, 1705, 47, 238, "Input",ExpressionUUID->"1889f6c6-62a7-45fe-a93d-ecef88ea6fef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142936, 3703, 560, 11, 108, "Subsection",ExpressionUUID->"69c048ae-5a3f-448b-9140-763ce72b2ab3"],
Cell[143499, 3716, 43158, 1000, 2750, "Input",ExpressionUUID->"37850a6a-391c-4faf-85a3-1b9dec2b9e5e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

